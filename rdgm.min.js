window.console||(window.console={log:function(){}}),rdgm_={};var rdgmf=function(){var qname="rdgm_",debug=[];debug.push(!1),debug.push(!1),debug.push(!1),debug.push(!1),debug.push(!1),debug.push(!1),debug.push(!1),debug.push(!1),debug.push(!1),debug.push(!1),debug.push(!1),debug.push(!1),debug.push(!1);var $=jQuery;this.no_intro_b=[],this.processing_complete_b=!1,this.qrecord_b=!1,this.dataset_b=!1,this.preview=!1,this.any_pay_quiz_f=!1,this.hotspot_alpha_value=121,this.hotspot_alpha_value_tmp=122,this.hotspot_border_alpha_value=254;var q=this,qqc,regular_page_f=!0,content,default_use_dict,default_use_terms,hint_timeout_sec,default_hangman_max_hints,correct,incorrect,errmsgs=[],n_rdgmzes=0,rdgm_edit_b,r_diagrams_page_f=!1,rdgmdata=[],header_html,drag_and_drop_initialized_b=!1,try_again_obj="",$label_clicked=[],$prev_label_clicked=[],ignore_label_click_b=!1,next_button_active_b=!1,textentry_b=!1,loaded_metaphone_js_b=!1,default_textentry_terms_metaphones,current_question_textentry_terms_metaphones={},textentry_answers={},textentry_answer_metaphones={},textentry_matches={},lc_textentry_matches={},textentry_i_rdgm,suppress_hangman_hint_b=!1,Tcheck_answer_message,show_hint_timeout={},panel_exit_mobile_open_b=!1,panel_exit_mobile_just_closed_b,non_mobile_scrollLeft,non_mobile_scrollTop,qw,set_rwizard_data_b=!1,preview_mode="questions_active";this.wordpress_page_f=!1;var reinit_highlighting_f=!1,restart_timer_i_rdgm=-1;function process_html(){$('p:contains("[!]"), :header:contains("[!]")').each((function(){0==$(this).html().search(/\s*(<.+?>)*\s*\[!+\][^]*?\[\/!+\]\s*(<.+?>)*\s*$/m)&&$(this).remove()})),$('p:contains("rdgm"), :header:contains("rdgm")').each((function(){var t=$(this).html();0==t.search(/\s*\[\/{0,1}rdgm[^\]]*\]\s*/m)&&$(this).replaceWith(t)})),q.rwizard_b||(q.wordpress_page_f=1==qqc.get_rdgm_param("wppf",""));var t="",e=$("div.rdgm_wrapper"),r=$("div.rdgm_wrapper_fallback");if(e.length)t="div.rdgm_wrapper",r.css({display:"none"});else{if(0==r.length){$("head").append('<style type="text/css">\n.rdgm_wrapper_fallback_visible {\nvisibility: visible;\n}\n</style>\n')}-1==(t=content).indexOf("wp-block-post-excerpt")&&(t+=", div.wp-block-post-excerpt")}n_rdgmzes=0;var a=0;$(t).each((function(){const t=$(this);var r=t.html();if(r){if(-1!=r.indexOf("[rdgm")){var d=q.process_html2(r,a);if(r=d.htm,q.rdgmdemos)for(var s=q.rdgmdemos.length,o=0;o<s;o++){var i=q.rdgmdemos[o],_=i.length;i=i.substring(10,_-11),r=r.replace("<rdgmdemo></rdgmdemo>",i)}if(d.replace_body){debug[0]&&console.log("[process_html] document_rdgm_user_logged_in_b:",document_rdgm_user_logged_in_b);var n='<div id="preview_header"><h2 style="margin-bottom: 10px;">Preview quiz</h2><a href="javascript: void (0)" style="float: right; margin-right: 50px;" onclick="'+qname+".reset_preview ("+a+')">Reload preview</a><label><input type="radio" name="preview_radio" value="questions_active"          onclick="'+qname+".change_preview_mode (this, "+a+')" checked /> Questions active</label>&emsp;<label><input type="radio" name="preview_radio" value="show_answers"              onclick="'+qname+".change_preview_mode (this, "+a+')" /> Show answers</label>&emsp;<label><input type="radio" name="preview_radio" value="show_answers_and_feedback" onclick="'+qname+".change_preview_mode (this, "+a+')" /> Show answers and feedback</label>&emsp;</div>';$("body").html(n+r),$("div#rdgm"+a).css({margin:"auto"})}else t.html(r);if(a!=d.i_rdgm){a=d.i_rdgm,t.find("div.rdgm").on("mouseenter",(function(t){if("div"==t.target.tagName.toLowerCase()&&"rdgm"==t.target.className)document_active_rdgm_qdeck=t.target;else{var e=$(t.target).parents("div.rdgm");e.length&&(document_active_rdgm_qdeck=e[0])}debug[7]&&(console.log("[rdgm mouseenter] e.target:",t.target),console.log("[rdgm mouseenter] document_active_rdgm_qdeck:",document_active_rdgm_qdeck))}));var m=a-1;if(rdgmdata[m])for(var g=rdgmdata[m].n_questions,c=0;c<g;c++)if(rdgmdata[m].bg_img[c]){var l=rdgmdata[m].bg_img[c],u=new Image;u.src=l.src,u.i_rdgm=m,u.i_question=c,u.onload=function(){var t,e=this.width,r=this.height,a=$("#rdgm"+u.i_rdgm+"-q"+u.i_question);debug[0]&&console.log("[process_html] w:",e,", h:",r,", $rdgmq:",a),t=l.height?l.height:l.width?Math.floor(l.width/e*r):r,t+="px",l.top&&(t="calc("+l.top+"px + "+t+")"),a.css({"min-height":t})}}}}e.length&&t.contents().unwrap()}else;})),n_rdgmzes=a,$("div.rdgm_wrapper").removeClass("rdgm_shortcodes_hidden"),$("div.hangman_label").each((function(){var t=$(this),e=t.outerWidth();t.outerWidth(1.2*e)}));for(a=0;a<n_rdgmzes;a++)if(rdgmdata[a].qrecord_id){var d={rdgm_qdeck:"rdgm",n_questions_cards:rdgmdata[a].n_questions};qqc.jjax(qname,a,rdgmdata[a].qrecord_id,"check_registered",d)}if(n_rdgmzes&&qqc.init_enter_intercept(),q.qrecord_b&&qqc.set_user_menus_and_icons(),textentry_b)if("body"==content&&"undefined"!=typeof qcard_){var s=0,o=function(){var t=!1;debug[6]&&console.log("[run_init_textentry_autocomplete]",s),(qcard_.processing_complete_b||s>30)&&(debug[6]&&console.log("[run_init_textentry_autocomplete] OK"),q.init_textentry_autocomplete($("body")),t=!0),t||(setTimeout(o,100),s++)};o()}else q.init_textentry_autocomplete($("body"));for(a=0;a<n_rdgmzes;a++){const t=$("#xrdgm"+a);if(t.length){t.css({height:"","min-height":""});const e=t.outerWidth();debug[0]&&console.log("[process_html] i_rdgm:",a,", initial_width:",e),e&&(rdgmdata[a].initial_width=e)}}q.processing_complete_b=!0}function dialog_no_credit_html(){return htm=[],htm.push('<div id="rdgm_dialog_no_credit" title="Quiz not assigned in your class">'),htm.push('<p style="margin-bottom: 1em;">'),htm.push("Note: this quiz has not been assigned as work you need to do."),htm.push("Your work will be recorded, but it may not count for your class."),htm.push("</p>"),htm.push("<p>"),htm.push("You can send a request message to your teacher asking them to include this quiz in your class."),htm.push("<br />"),htm.push("<br />"),htm.push('<button id="rdgm_request_assign_to_class" class="rdgm_button" onclick="rdgm_utils.request_assign_to_class (1)">'),htm.push("Send request"),htm.push("</button>"),htm.push("</p>"),htm.push("<br />"),htm.push('<div id="rdgm_request_assign_to_class_feedback">'),htm.push("</div>"),htm.push("<p>"),htm.push("<label>"),htm.push('<input type="checkbox" onclick="rdgm_utils.do_not_show_assign_to_class (this)" />'),htm.push("Don&rsquo;t show me this again for quizzes and flashcard decks on this page"),htm.push("</label>"),htm.push("</p>"),htm.push("</div>"),htm.join("\n")}function create_rdgm_divs(t,e,r,a){var d=e.match(/\[rdgm([^\]]*)\]/m),s=d[1];debug[0]&&console.log("[create_rdgm_divs] attributes: ",s);var o=[];if(-1!=(s=qqc.replace_smart_quotes(s)).search(/[\s;"]width/m)){var i=s.replace(/(style\s*=\s*"[^"]*)/,"$1");i=i.replace(/;\s*;/g,";"),o.push('<div id="xrdgm'+t+'" class="xrdgm" '+i+"></div>\n")}if(rdgmdata[t].align){var _=rdgmdata[t].align,n="";if("center"==_)n="margin: auto;";else if("right"==_)n="margin-left: auto;";else if("tiled"==_&&(n="float: left;",rdgmdata[t].spacing)){var m=rdgmdata[t].spacing+"px !important";n+=" margin-left: "+m+"; margin-bottom: "+m+";"}(d=s.match(/style\s*=\s*"[^"]*/m))?s=(s=s.replace(/(style\s*=\s*"[^"]*)/m,"$1; "+n)).replace(/;\s*;/g,";"):s+=' style="'+n+'"',s=s.replace(/align\s*=\s*"[^"]*"/,""),debug[0]&&console.log("[create_rdgm_divs] attributes: ",s)}o.push('<div id="rdgm'+t+'" class="rdgm visibilityhidden" '+s+">"),o.push('<div id="overlay-times-up-rdgm'+t+'" class="overlay-times-up">'),o.push('<div class="overlay-times-up-msg">'),o.push("Sorry, time&rsquo;s up"),o.push("</div>"),o.push("</div>"),o.push('<div id="overlay-exit-mobile-rdgm'+t+'" class="overlay-exit-mobile-rdgm" onclick="'+qname+'.close_panel_exit_mobile(this)">'),o.push('<div id="panel-exit-mobile-rdgm'+t+'" class="panel-exit-mobile-rdgm">'),o.push('<button onclick="'+qname+".exit_mobile ("+t+')">'),o.push("Back to page view"),o.push("</button>"),o.push("<br />"),o.push("<span>"),o.push("(To return to this full-screen view, tap "),o.push('<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAIAAADZF8uwAAAAk0lEQVR4nI3QMQ6EIBAF0BG2YLiGtjRcgt7EcBfDhShtbLwBHIgCJrPFbrGJqPvrl/k/MzAzPOUFAMYYRCSiaZpijGckAAARSynM3BVf1FpTSkkpQwiXaBzHnLNzbtu2Lhr+GS4exSUyxqzrCgDLssDnBefM87zv+3EcRHS3yVpba0XElFK/znsvhNBal1LuLv3mDbu1OYLB67+mAAAAAElFTkSuQmCC" />'),o.push(")"),o.push("</span>"),o.push('<div class="panel-icon-exit-mobile-rdgm"></div>'),o.push("</div>"),o.push("</div>"),o.push('<div id="icon-exit-mobile-rdgm'+t+'" class="icon-exit-mobile-rdgm" onclick="'+qname+".open_panel_exit_mobile ("+t+')"></div>');n="";""!=header_html&&"NA"!=header_html&&-1==header_html.indexOf("Enter header text")||(n=' style="display: none;"'),o.push('<div class="header-rdgm'+t+' rdgm-header rdgm_editable"'+n+">"),o.push(header_html),o.push("</div>"),o=o.join("\n");const g=qqc.get_rdgm_param("url","./");var c=[];c.push('<div class="rdgm-progress-container rdgm'+t+'">'),c.push('<div class="go-mobile-rdgm go-mobile-rdgm'+t+'" onclick="'+qname+".go_mobile ("+t+')" title="Full-screen view">'),c.push("</div>"),c.push('<img src="data:image/png;base64,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" class="go-mobile-rdgm go-mobile-rdgm'+t+'" />'),c.push('<div class="exit-mobile-rdgm exit-mobile-rdgm'+t+'" onclick="'+qname+".exit_mobile ("+t+')" title="Exit full-screen view">'),c.push("</div>"),c.push('<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAVlpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KTMInWQAAAoVJREFUSA2lVj2PEkEY3plZV5I9Q3KBqzFHQkFJaCx0sTCxo6EnsfMPWPjBctqoueqMNf/CwtODxo7ySCxMaAjhgiRGiXjsh8+zzl5WKoZ7k+GdnZ33ed6PeWdRtVrtxnQ6jWxbvrUs8SCO449cq1Qqst1uWxBVr9fFaDSKW62WouaikTiO0xVCxBy2bXdpXC6Xb5ZKpZzv+xKkIp/PH3JuBMzN9FyD/4Fea5IjvmMk1FLKExAfc24sMH6tCQgeYgSa5BXB4MAz/ewbg6cG8M4niAZPotDPZ1ozdZ10v5GuVqsODTIkJGIkkQZn6q5qYwSOzbJYLEYsaBAEvlLqpQYQWq+h07leMlPS87wI4IIFhX4B8zMNGkAnRTaD/H+37Pf7PO+Xw+FwzYLidQPjUm9jBCSiRP+U4S+bJ44twaOoc570w+YcNUIjmkuSXzbRcrl8DPOfGOzUbEPR8z0QfFitVp8xNxNGsG2Hpo1nxmC4e1sSOo0DZO90BHO53H2cuIfw7RfGZjqJeWt/331/cfHjG+bmwoJvHoLss1LyHS9Ipl+ZwyeX3x0AeLD9re15EEIM9KrqhGH4BIQSV7vMhqf3bqVSOxu702bkldNH6o5Yp16v57CJd42ggQjuAZCec5CIchvpsyeTyWmhUFCLxcK6LgHTklyW0OwfAeK74JDz+fzUdd2UGK8MBACdTFGvrnSs8apPvyddQl4nAg8FfR5F0SOmhZ4DL4kCOsRzA9fPHkmMBXjHOIonNEwbD2tdHRWjSL4hIHhjDM4OPTjIH8JDwTn/GPB7QiCQpF9GfqB8ru2SInV+/vX7YDCwx+OxaDabAU8LCzqbzT7BaxcRfEEvPGV0fwEIA/zW345reQAAAABJRU5ErkJggg==" class="exit-mobile-rdgm exit-mobile-rdgm'+t+'" />');var l,u=rdgmdata[t].n_questions;!(u>1||rdgmdata[t].use_dataset||rdgmdata[t].use_dataset_questions_htm)||q.preview&&!q.preview_i_rdgm_plus1||(n="",rdgmdata[t].hide_forward_back_b&&(n=' style="visibility: hidden;"'),l=rdgmdata[t].use_dataset&&rdgmdata[t].dataset_intro_f?T("Go to &ldquo;Choose questions&rdquo;"):T("Go to first question"),c.push('<span class="bbfe-wrapper bbfe-wrapper'+t+'">'),c.push('<span class="bbfe bbfe-rdgm'+t+" bck-question-rdgm"+t+'"'+n+' onclick="'+qname+".bck_question ("+t+', true )" title="'+l+'">'),c.push('<img class="icon-beg-end-rdgm" src="'+g+'/images/icon_beg.svg">'),c.push("</span>"),c.push('<span class="bbfe bbfe-rdgm'+t+" bck-question-rdgm"+t+'"'+n+' onclick="'+qname+".bck_question ("+t+', false)" title="'+T("Go to previous question")+'">'),c.push('<img class="icon-bck-fwd-rdgm" src="'+g+'/images/icon_bck.svg">'),c.push("</span>"),c.push('<span class="question-number-rdgm question-number-rdgm'+t+'"'+n+">"),c.push("</span>"),c.push('<span class="bbfe bbfe-rdgm'+t+" fwd-question-rdgm"+t+'"'+n+' onclick="'+qname+".fwd_question ("+t+', false)" title="'+T("Go to next question")+'">'),c.push('<img class="icon-bck-fwd-rdgm" src="'+g+'/images/icon_fwd.svg">'),c.push("</span>"),c.push('<span class="bbfe bbfe-rdgm'+t+" fwd-question-rdgm"+t+'"'+n+' onclick="'+qname+".fwd_question ("+t+', true )" title="'+T("Go to most-recent question")+'">'),c.push('<img class="icon-beg-end-rdgm" src="'+g+'/images/icon_end.svg">'),c.push("</span>"),c.push("</span>"));n="";var h="";if(!rdgmdata[t].rdgm_timer&&!rdgmdata[t].question_time_limit||q.preview||(n=' style="display: inline-block;"',h="0:00",rdgmdata[t].question_time_limit&&(h=qqc.hhmmss_from_sec(rdgmdata[t].question_time_limit))),c.push('<span id="rdgm'+t+'-timer" class="rdgm-timer"'+n+">"+h+"</span>"),rdgmdata[t].qrecord_id){c.push('<span class="response_recorded_wrapper response_recorded_wrapper-rdgm'+t+'">'),c.push('<span class="response_recorded response_recorded-rdgm'+t+'">'),c.push("&#x2714;&#xFE0E;"),c.push("</span>"),c.push('<span class="response_recorded response_recorded_shadow response_recorded_shadow-rdgm'+t+'">'),c.push("&#x2714;&#xFE0E;"),c.push("</span>"),c.push("</span>"),c.push('<div class="rdgm_icon_and_menu_container  lock_unlock rdgm'+t+'">'),c.push('<div id="locked-rdgm'+t+'" class="rdgm-locked rdgm_menu_icon">'),c.push('<img src="'+g+'/images/icon_locked.png" />'),c.push("</div>"),c.push('<div id="unlocked-rdgm'+t+'" class="rdgm-unlocked rdgm_menu_icon">'),c.push('<img src="'+g+'/images/icon_unlocked.png" />'),c.push("</div>"),c.push('<div class="rdgm_icon_trigger_and_menu rdgm-hover">'),c.push('<div class="rdgm_icon_trigger">'),c.push("</div>"),c.push('<div id="pay_unlock_menu-rdgm'+t+'" class="rdgm-pay_unlock_menu rdgm_menu">'),c.push("</div>"),c.push("</div>"),c.push("</div>");var p="";(q.no_intro_b[t]||1==u)&&(p=" rdgm-usermenu_icon_no_intro"),c.push('<div class="rdgm_icon_and_menu_container rdgm'+t+'">'),c.push('<div class="rdgm-usermenu_icon rdgm_menu_icon'+p+'">'),c.push("&#x25bc;"),c.push("</div>"),c.push('<div class="rdgm_icon_trigger_and_menu rdgm-hover">'),c.push('<div class="rdgm_icon_trigger" style="left: -12px; top: -4px;">'),c.push("</div>"),c.push('<div id="usermenu-rdgm'+t+'" class="rdgm-usermenu rdgm_menu">'),c.push("</div>"),c.push("</div>"),c.push("</div>")}n="",rdgmdata[t].hide_progress_b&&(n=' style="display: none;"'),c.push('<div id="progress-rdgm'+t+'" class="rdgm-progress"'+n+">"),c.push("</div>"),c.push("</div>"),c=c.join("\n");var b="";(rdgmdata[t].qrecord_id||rdgmdata[t].use_dataset)&&(b='<div id="rdgm_login-rdgm'+t+'" class="rdgm-login">\n</div>');var f=[];return u>1||rdgmdata[t].use_dataset||rdgmdata[t].use_dataset_questions_htm||q.rwizard_b?(a&&-1!=a.indexOf("[unpaid")&&-1!=a.indexOf("[/unpaid]")?a=(a=a.replace("[unpaid]",'<span class="unpaid_msg">')).replace("[/unpaid]","</span>"):a+='<span class="unpaid_msg_payment_type unpaid_msg"></span>',rdgmdata[t].use_dataset&&!q.preview&&-1==a.indexOf("[restart")&&(a+="<br />[restart]"),a&&(a=create_restart_button(t,a)),q.rwizard_b&&(a=qqc.shortcodes_to_video_elements(a)),rdgmdata[t].summary_b&&f.push(create_summary_report_div(t,a))):(1==u&&a&&(a=create_restart_button(t,a),f.push('<div class="single-question_exit">'),f.push(a),f.push("</div>")),rdgmdata[t].rdgm_edit_b||rdgmdata[t].hotspot_b||rdgmdata[t].qrecord_id||qqc.is_mobile(rdgmdata[t].mobile_enabled)||q.rwizard_b||(c="")),f.push('<div class="next_button" id="next_button-rdgm'+t+'">\n'),f.push('<button class="rdgm_button" onclick="'+qname+".next_question ("+t+')">'),f.push('<span id="next_button_text-rdgm'+t+'">'),f.push(T("Start quiz")),f.push("</span>"),f.push("</button>\n"),f.push("</div>\n"),rdgmdata[t].summary_b||u>1&&a&&f.push(create_summary_report_div(t,a)),rdgmdata[t].hide_r_diagrams_icon_b||rdgmdata[t].icon_swhs||f.push(create_icon_rdgm_div(t)),f.push("</div>"),r=o+c+b+r+f.join("")+"</div>\n"}function create_icon_rdgm_div(t){const e=rdgmdata[t].icon_swhs;var r=[];r.push('<div class="icon_rdgm" id="icon_rdgm'+t+'">');var a=qqc.get_rdgm_param("icon_rdgm");if("Not displayed"!=a){const t=e?"swinginghotspot":"r_diagrams";"Icon only"!=a&&r.push('<a href="mailto:support@'+t+'.com" style="border: none; box-shadow: none;">');const s="Questions, comments, suggestions? support@"+t+".com";var d;d=e?"iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAABnWAAAZ1gEY0crtAAABiElEQVQ4jZWSv0sCYRyHnzvvinCIhBwEoyFBcJB0CKSmBJejIWhqbAuhv8DFCAdndRehqVDIKdokWlsEI1qiqesMkQNf77yGC/qh1t0zfvg8vO/3fb/gnUiE8/PvgexDLhQIh330v0ilEILNze+Z8qMRCLC7y+oqqoosI8s4DrZNr0e5jK6jafR6mOYs+fSUoyOenrBtAElClllYYGMDReHiguNj3t6oVmfdrVik2yUU+hFms+g6Z2fkcoxGbG3NGUxVabfpdFha+kySSSwLIahUeH/n5OTPhwkGubuj1UJRANJphMCycBxqtT9Nl3CYx8evwba3MQxublBVDzIQi/H6Sj4P0Gjw8MDKijfTZW8Pw2B/n8GAeNyPCSwv4zjU6zSb8yrz19OyAIJBhkP/8mQCIEmMx/5lF3c9fcvuPwvB4uI/B/xmfZ12m+dnNA3TpFQiEPAs399zfc3aGsDODobB4aFn+fIS2+bqioMD+n1Mk0xmuiXNliWJRIJolJcXolFub+n3p1sfn3l/Jjmrf3gAAAAASUVORK5CYII=":"iVBORw0KGgoAAAANSUhEUgAAABAAAAAUCAIAAAALACogAAAABnRSTlMA/wD/AP83WBt9AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABP0lEQVR4nGP8//8/AymAiSTV5GhgwSZ4rcRrxRooW3futlBnJDlGND/cXzXVccFLVP0oepiwqtZJyH2wrenBtogQBgYGhsv9q15j9cO1qTDVW8JEGRgYGBi0PJ0YGBgYrjzCpuH+qv1rGBgYGHQLoaoZGBgYlOTEGRgYGB68uY+h4fXuQy8ZGBgYnLSRvXjv0UsGBgYGBRFFdA1Prm+6x8DAwBBio4XsyO37GBgYGHTkEHaixYO4mszrWTl1CjmH7iMcKe5nhdAAi4cnL6/A3HbrHgMDw56pJ0QYIOHr5JgmgzASZoOFdggDAwPDy03HRCEhs6YJEne6c0uQHYkUcXt76pL3oTqQQbxqVjay8Sh+cC5pmuuEpkFMWQZNBCNpwMDrWTmT2+5hCCu54EqtomkVLjqYwgoiuGzACWifgQDhK2rq5bcX2gAAAABJRU5ErkJggg==",r.push('<img class="icon_rdgm" style="border: none;" title="'+s+'" src="data:image/png;base64,'+d+'" />'),"Icon only"!=a&&r.push("</a>")}return r.join("")}function create_summary_report_div(t,e){return bottom_html=[],bottom_html.push('<div id="summary-rdgm'+t+'" class="rdgm-summary">\n'),bottom_html.push('<div id="summary_report-rdgm'+t+'" class="rdgm_summary_report">'),bottom_html.push("</div>\n"),bottom_html.push('<div id="summary-quiz_times_histogram-rdgm'+t+'">'),bottom_html.push("</div>\n"),bottom_html.push('<div id="rdgm_exit-rdgm'+t+'" class="rdgm-exit rdgm_editable">'),bottom_html.push(e),bottom_html.push("</div>\n"),bottom_html.push('<button class="summary_exit_mobile_rdgm" onclick="'+qname+".exit_mobile ("+t+')">\n'),bottom_html.push("Return to page view"),bottom_html.push("</button>\n"),bottom_html.push("</div>\n"),bottom_html.join("")}function get_login_html(t,e,r,a){e=e?1:0,a=a?1:0;var d="onfocus=\"jQuery ('#rdgm_login-rdgm"+t+" p.login_error').hide ()\"",s="<p>";s+=r?"<strong>"+r+"</strong>":e?"<strong>"+T("Add team member")+"</strong>":"<strong>"+T("Record score/credit?")+"</strong>",s+="</p>",s+='<form action="nada" onSubmit="return rdgm_.login ('+t+", "+e+", "+a+')">\n<table border="0" align="center" width="100%"><tr><td><label for="rdgm_username-rdgm'+t+'"><nobr>'+T("Login name")+'</nobr></label></td><td><input type="text" id="rdgm_username-rdgm'+t+'" '+d+' /></td></tr><tr><td><label for="rdgm_password-rdgm'+t+'">'+T("Password")+'</label></td><td><input type="password" id="rdgm_password-rdgm'+t+'" /></td></tr><tr><td style="text-align: right;"><span class="rdgm-remember" title="'+T("Save preference (do not use on shared computer)")+'"><label><span class="rdgm-remember"><input type="checkbox" />&nbsp;'+T("Remember")+'</span></label></span></td><td><button type="submit" class="rdgm_button">'+T("Student login")+"</button>&ensp;",e||(s+='<span class="rdgm_button" onclick="rdgm_utils.create_register_taker_screen (\''+qname+"', "+t+", "+a+')">'+T("New student - register")+"</span>&ensp;"),s+='<span class="rdgm_login_cancel_no_thanks rdgm_button" onclick="'+qname+".no_login ("+t+","+e+')">',s+=T(e?"Cancel":"No thanks"),s+="</span></td></tr>",e||(s+='<tr><td></td><td class="rdgm-smaller"><a href="'+qqc.get_rdgm_param("server_loc","http://r_diagrams.com/admin")+'/password_reset_request" target="_blank">'+T("Forgot password?")+"</a></td></tr>");var o="new_account";return-1!=window.location.href.indexOf("learn-biology.com")&&(o="new_account_smv"),s+='<tr><td colspan="2"><hr style="margin: 5px;"></td></tr><tr><td colspan="2" class="rdgm-center"><b>'+T("Teachers: track your students&rsquo; progress on quizzes and flashcards")+'.&nbsp; <a href="'+qqc.get_rdgm_param("secure_server_loc","https://r_diagrams.com/admin")+"/"+o+'" target="_blank"><nobr>'+T("Create teacher administrative account")+'</nobr></a></b></td></tr></table>\n</form><p class="login_error">'+T("Login incorrect. Please try again")+"</p>\n"}function create_restart_button(t,e,r){var a=e.match(/\[restart[^\]]*\]/);if(a){var d;d=r||1==rdgmdata[t].n_questions?T("Do this question again"):rdgmdata[t].use_dataset&&rdgmdata[t].dataset_intro_f?T("Practice more questions"):T("Take this quiz again");var s=get_attr(qqc.replace_smart_quotes(a[0]),"label");s&&(d=s);var o='<button class="rdgm_button rdgm_restart" onclick="'+qname+"."+(r?"redo_question":"restart_quiz")+" ("+t+')">'+d+"</button>";e=e.replace(a,o)}return e}function create_bg_img_style(t,e){var r="",a=rdgmdata[t].bg_img[e];if(a){var d=a.top?a.top+"px":"0";r=' style="background: no-repeat '+(a.left?a.left+"px":"0")+" "+d+" / "+(a.width?a.width+"px":"auto")+" "+(a.height?a.height+"px":"auto")+" url("+a.src+')"';debug[0]&&console.log("[create_bg_img_style] style:",r)}return r}function process_question_attributes(t,e,r,a){set_rwizard_data_b&&(void 0===a&&(a=e),qw.questions_cards[a]={}),rdgmdata[t].dataset_id[e]=e,rdgmdata[t].unit[e]=rdgmdata[t].default_unit;var d=r.match(/\[(<code><\/code>)*q\s*([^\]]*)\]/m)[2];if(d){d=qqc.replace_smart_quotes(d),set_rwizard_data_b&&(qw.questions_cards[a].question_attributes=d),q.rwizard_b&&(rdgmdata[t].rwizard_multiple_choice_b[e]="true"==get_attr(d,"multiple_choice"));var s=get_attr(d,"topic",!0);if(s||(s=get_attr(d,"unit",!0)),s){debug[4]&&console.log("[process_question_attributes] question_topics: ",s),set_rwizard_data_b&&(qw.questions_cards[a].topic=s),s=s.split(/; */);for(var o=0;o<s.length;o++){s[o]=s[o].replace(/\s/g,"_");var i=s[o];-1==rdgmdata[t].topics.indexOf(i)&&rdgmdata[t].topics.push(i)}rdgmdata[t].question_topics[e]=s}var _=get_attr(d,"dataset_id");_&&(rdgmdata[t].dataset_id[e]=_);var n=get_attr(d,"unit");n&&(rdgmdata[t].unit[e]=n,set_rwizard_data_b&&(qw.questions_cards[a].unit=n),-1==rdgmdata[t].units.indexOf(n)&&rdgmdata[t].units.push(n));var m=get_attr(d,"use_dataset_question");m&&(rdgmdata[t].use_dataset_question_ids[e]=m,rdgmdata[t].dataset_id[e]=m,set_rwizard_data_b&&(qw.questions_cards[a].from_dataset_b=!0));var g=get_attr(d,"bg_img_src");if(g){var c={};c.src=g,c.left=get_attr(d,"bg_img_left"),c.top=get_attr(d,"bg_img_top"),c.width=get_attr(d,"bg_img_width"),c.height=get_attr(d,"bg_img_height"),rdgmdata[t].bg_img[e]=c,set_rwizard_data_b&&(qw.questions_cards[a].bg_img=c)}const r=get_attr(d,"hotspot_user_interaction");r&&(rdgmdata[t].hotspot_user_interaction[e]=r,set_rwizard_data_b&&(qw.questions_cards[a].hotspot_user_interaction=r));const l=get_attr(d,"hotspot_labels_stick");l&&(rdgmdata[t].hotspot_labels_stick[e]=l,set_rwizard_data_b&&(qw.questions_cards[a].hotspot_labels_stick=l));const u=get_attr(d,"show_hotspots");u&&(rdgmdata[t].show_hotspots[e]=u,set_rwizard_data_b&&(qw.questions_cards[a].show_hotspots=u));const h=get_attr(d,"find_the_dot_width");h&&(rdgmdata[t].find_the_dot[e]={},rdgmdata[t].find_the_dot[e].width=h,rdgmdata[t].find_the_dot[e].height=get_attr(d,"find_the_dot_height"),rdgmdata[t].find_the_dot[e].dot_color=get_attr(d,"find_the_dot_dot_color"),rdgmdata[t].find_the_dot[e].background_color=get_attr(d,"find_the_dot_background_color"),rdgmdata[t].find_the_dot[e].controls="false"!=get_attr(d,"find_the_dot_controls"))}return s}function check_questions_have_topics(t){for(var e=!1,r=0;r<rdgmdata[t].n_questions;r++)rdgmdata[t].information_question_b[r]||rdgmdata[t].question_topics[r]||(rdgmdata[t].question_topics[r]=["Other"],e=!0);e&&-1==rdgmdata[t].topics.indexOf("Other")&&rdgmdata[t].topics.push("Other"),debug[4]&&console.log("[check_questions_have_topics] rdgmdata[i_rdgm].question_topics:",rdgmdata[t].question_topics),rdgmdata[t].topic_statistics={};for(var a=rdgmdata[t].topics.length,d=0;d<a;d++){var s=rdgmdata[t].topics[d];rdgmdata[t].topic_statistics[s]={},rdgmdata[t].topic_statistics[s].n_correct=0,rdgmdata[t].topic_statistics[s].n_incorrect=0}}function start_rdgm_timer(t,e){if(debug[0]&&console.log("[start_rdgm_timer] i_rdgm:",t,", time_limit_sec:",e),!q.rwizard_b&&!rdgmdata[t].timer_interval_id&&!q.preview){const r=$("#rdgm"+t+"-timer");if(rdgmdata[t].$rdgm_timer=r,e){const a=qqc.hhmmss_from_sec(e);r.html(a),rdgmdata[t].timer_interval_id=setInterval(update_rdgm_timer,1e3,t,!0),rdgmdata[t].times_up_msec=(new Date).getTime()+1e3*e+500}else rdgmdata[t].timer_interval_id=setInterval(update_rdgm_timer,1e3,t),rdgmdata[t].timer_start_msec=(new Date).getTime()}}function stop_rdgm_timer(t,e=!1){if(rdgmdata[t].timer_interval_id){if(clearInterval(rdgmdata[t].timer_interval_id),rdgmdata[t].timer_interval_id="",!e&&rdgmdata[t].qrecord_id&&document_rdgm_user_logged_in_b){var r={elapsed_time:parseInt(((new Date).getTime()-rdgmdata[t].timer_start_msec)/1e3),callback:"record_quiz_time_callback"};qqc.jjax(qname,t,rdgmdata[t].qrecord_id,"record_quiz_time",r)}-1!=rdgmdata[t].qrecord_id.indexOf("finish_times_demo")&&(rdgmdata[t].elapsed_time=parseInt(((new Date).getTime()-rdgmdata[t].timer_start_msec)/1e3))}}function update_rdgm_timer(t,e){var r;e?(r=parseInt((rdgmdata[t].times_up_msec-(new Date).getTime())/1e3))<=0&&(times_up(t),r=0):r=parseInt(((new Date).getTime()-rdgmdata[t].timer_start_msec)/1e3);const a=qqc.hhmmss_from_sec(r);rdgmdata[t].$rdgm_timer.html(a)}function times_up(t){stop_rdgm_timer(t,!0),rdgmdata[t].$rdgm_timer.html("0:00"),$("div#overlay-times-up-rdgm"+t).show(),rdgmdata[t].n_incorrect++,update_progress_show_next(t)}function check_timers(){for(var t=0;t<n_rdgmzes;t++)if(rdgmdata[t].timer_interval_id){stop_rdgm_timer(t,!0),restart_timer_i_rdgm=t;break}}function hide_current_question(t,e){var r="rdgm"+t+"-q"+e;$("#"+r).hide(),document_rdgm_mobile&&$("#mobile_"+r).hide()}function scale_quiz_to_container_when_visible(t,e){debug[0]&&(console.log("[scale_quiz_to_container_when_visible] entries:",t),console.log("[scale_quiz_to_container_when_visible] observer:",e));const r=$(t[0].target);r.is(":visible")&&(scale_quiz_to_container(r),e.unobserve(t[0].target))}function scale_quiz_to_container(t){var e=t.outerWidth(),r=t.parent();if(r.length){var a=r.width();if(a>0&&e>a){const d=a/e,s=Math.round(50*(1-d)),o="rtl"==getComputedStyle(r[0]).direction?1:-1;t.css({transform:"translate("+o*s+"%, -"+s+"%) scale("+d.toFixed(3)+")"}),qqc.offset_height_rescale(t,d);const i=t[0].id.match(/rdgm(\d+)/);if(i){const e=i[1];debug[0]&&(console.log("[scale_quiz_to_container] $rdgm:",t),console.log("[scale_quiz_to_container] i_rdgm:",e)),rdgmdata[e].width_reset=!0}t[0].qscale_fac=d}}}$(document).ready((function(){qqc=rdgm_utils;var t=$.cookie("rdgm_preview");void 0!==t&&(q.preview_i_rdgm_plus1=parseInt(t,10)+1,$.removeCookie("rdgm_preview",{path:"/"})),debug[0]&&(console.log("[rdgm.js > document ready] typeof (document_rwizard_user_page):",typeof document_rwizard_user_page),console.log("[rdgm.js > document ready] q.preview_i_rdgm_plus1:",q.preview_i_rdgm_plus1)),correct=[S("Good!"),S("Correct!"),S("Excellent!"),S("Great!")],incorrect=[S("Sorry, no."),S("No, that's not correct."),S("Sorry, that's not correct.")];var e=document.location.href;r_diagrams_page_f=-1!=e.indexOf("r_diagrams.com/u/")||-1!=e.indexOf("r_diagrams.com/admin/")||-1!=e.indexOf("r_diagrams.net/u/")||-1!=e.indexOf("r_diagrams.net/admin/")||-1!=e.indexOf("localhost/u/")||-1!=e.indexOf("localhost/admin/")||-1!=e.indexOf("192.168.1.120/u/")||-1!=e.indexOf("192.168.1.120/admin/"),"undefined"==typeof document_rwizard_user_page&&-1==e.indexOf("admin-ajax")&&-1==window.location.href.indexOf("action=edit")&&-1==window.location.href.indexOf("post-new")?q.rdgm_init():regular_page_f=!1})),this.rdgm_init=function(t,e){if(content=qqc.get_rdgm_param("content","body"),default_use_dict=qqc.get_rdgm_param("use_dict","true"),default_use_terms=qqc.get_rdgm_param("use_terms","true"),default_hangman_max_hints=parseInt(qqc.get_rdgm_param("hangman_hints",2),10),hint_timeout_sec=qqc.get_rdgm_param("hint_timeout_sec",20),q.r_diagrams_version=qqc.get_rdgm_param("r_diagrams_version",""),document_rdgm_mobile_enabled=qqc.get_rdgm_param("mobile_enabled","Always"),"Enabled"==document_rdgm_mobile_enabled&&(document_rdgm_mobile_enabled="Always"),Tcheck_answer_message=T('Need help?  Try the "hint" button'),!e){if(qqc.set_force_mobile(),process_html(),errmsgs.length&&!t&&(q.rwizard_b||(qqc.get_rdgm_param("regular_page_error_check")?alert(plural(S("Error found"),S("Errors found"),errmsgs.length)+":\n\n"+errmsgs.join("\n")):console.log("Errors found:\n",errmsgs.join("\n")))),document_rdgm_force_mobile_f&&q.go_mobile(0),n_rdgmzes){for(var r=0;r<n_rdgmzes;r++)if(rdgmdata[r].questions){if(!document_rdgm_force_mobile_f){const t=rdgmdata[r].mobile_enabled;("Always"==t||"Small screens only"==t&&qqc.is_mobile(t))&&$(".go-mobile-rdgm"+r).show()}rdgmdata[r].qrecord_id&&(rdgmdata[r].record_start_b=!0),rdgmdata[r].use_dataset||q.init_question_order(r),q.no_intro_b[r]||1==rdgmdata[r].n_questions||q.preview_i_rdgm_plus1?q.next_question(r):rdgmdata[r].display_pay_screen||($("div.intro-rdgm"+r).show(),$("div#next_button-rdgm"+r).show())}if(q.$dialog_no_credit||($("body").append(dialog_no_credit_html()),q.$usernames_is_are=$("#rdgm_usernames_is_are"),q.$dialog_no_credit=$("#rdgm_dialog_no_credit").dialog({height:400,width:550,modal:!0,autoOpen:!1,open:function(){check_timers(),$("div#rdgm_request_assign_to_class_feedback").html(""),$("button#rdgm_request_assign_to_class").removeClass("rdgm_button_disabled").removeAttr("disabled")},buttons:{Close:function(){if(q.$dialog_no_credit.dialog("close"),-1!=restart_timer_i_rdgm){const t=restart_timer_i_rdgm;rdgmdata[t].question_time_limit?start_rdgm_timer(t,rdgmdata[t].question_time_limit):start_rdgm_timer(t),restart_timer_i_rdgm=-1}}}})),q.preview_i_rdgm_plus1){var a=q.preview_i_rdgm_plus1-1;rdgmdata[a].use_dataset||q.init_preview(a)}else q.preview&&!q.rwizard_b&&q.init_preview(0)}reinit_highlighting_f&&("undefined"!=typeof Prism?Prism.highlightAll():"undefined"!=typeof hljs&&$("code").each((function(t,e){hljs.highlightBlock(e),this.style.display="inline-block"})))}},this.process_html2=function(t,e,r,a){var d=new RegExp("\\[rdgmdemo\\][\\s\\S]*?\\[\\/rdgmdemo\\]","gm");q.rdgmdemos=t.match(d),q.rdgmdemos&&(t=t.replace(d,"<rdgmdemo></rdgmdemo>"),debug[0]&&console.log("[process_html2] q.rdgmdemos.length: ",q.rdgmdemos.length));var s=0,o=check_rdgm_tag_pairs(t=(t=t.replace(/<!--[^]*?-->/gm,"")).replace(/\[!+\][^]*?\[\/!+\]/gm,""));if(o)t=o,"undefined"!=typeof rwizard&&(rwizard.errmsgs=errmsgs);else{rdgm_edit_b=!1;var i=t.match(/\[rdgm[^]*?\[\/rdgm\]/gm);if(i){s=i.length,debug[0]&&(console.log("[process_html2] local_n_rdgmzes: ",s),console.log("                rdgm_matches[0]: ",i[0])),q.preview_i_rdgm_plus1&&(q.preview=!0);var _=!0,n=!1;q.quizzes_questions=[];for(var m=0;m<s;m++){if(q.preview_i_rdgm_plus1&&(q.preview_i_rdgm_plus1==e+1?(n=!0,_=!0):_=!1),_){var g=q.process_rdgm_pair(i[m],e,r,a,a);if(a&&(rwizard.questions_cards&&rwizard.questions_cards.length&&(debug[0]&&console.log("[process_html2] rwizard.questions_cards:",rwizard.questions_cards),rwizard.questions_cards[0].dataset_b=rwizard.questions_cards_dataset_b,q.quizzes_questions[e]=JSON.parse(JSON.stringify(rwizard.questions_cards))),debug[0]&&(console.log("[process_html2] i_rdgm:",e,", rwizard.questions_cards:",rwizard.questions_cards),rwizard.questions_cards))){console.log("[process_html2] JSON.stringify (rwizard.questions_cards):",JSON.stringify(rwizard.questions_cards)),console.log("[process_html2] rwizard.questions_cards.length:",rwizard.questions_cards.length);for(var c=rwizard.questions_cards.length,l=0;l<c;l++)""==rwizard.questions_cards[l]&&console.log("[process_html2] NULL JSON ii:",l)}t=t.replace(/(<[ph][^>]*>\s*)*?\[rdgm[^]*?\[\/rdgm\]/m,(function(){return g}))}else rdgmdata[e]={};e++}if(debug[0]&&q.quizzes_questions.length)for(var u=q.quizzes_questions.length,h=0;h<u;h++)console.log("[process_html2] q.quizzes_questions["+h+"]:",q.quizzes_questions[h]);debug[3]&&console.log("[process_html2] htm:",t)}}return debug[0]&&console.log("[process_html2] replace_body:",n),{htm:t,i_rdgm:e,replace_body:n}},this.reset_preview=function(t){$.cookie("rdgm_preview",t,{path:"/"}),window.location=window.location.href},this.process_reg_code=function(t){if(debug[0]&&console.log("[process_reg_code] reg_code:",t),""!=t){var e={reg_code:t};qqc.jjax(qname,0,0,"reg_code_add_to_class",e)}},this.hide_reg_code_error=function(){$("div.rdgm_reg_code_errmsg").html("").hide()},this.set_i_rdgm_i_question=function(){debug[0]&&console.log("[set_i_rdgm_i_question] this:",this);var t=this.id,e=t.match(/rdgm([^-]+)/)[1],r=t.match(/-q(.+)/)[1];rdgmdata[e].i_question=r},this.init_rdgm_edit=function(t,e,r){var a;debug[0]&&console.log("[init_rdgm_edit] i_rdgm:",e),sibs={};var d=0;t.find("div.rdgm_edit_canvas .rdgm_edit_target").each((function(){var t=$(this);t.removeClass("ui-draggable ui-draggable-handle"),t.css({"border-style":"dotted","border-color":"gray"});var e=t.attr("class").match(/qtarget_sib-([0-9]+)/);if(e){var r=e[1];sibs[r]?a=sibs[r]:(a="t"+d,sibs[r]=a,d++)}else a="t"+d,d++;t.attr("id",a),t.on("click",(function(t){debug[8]&&console.log("[target clicked] $ (event.target):",$(t.target));var e=$(t.target);e.hasClass("rdgm_edit_target")&&(e.droppable("option","disabled")||q.label_dropped(e))}))})),t.find("td.rdgm_edit_labels div.rdgm_edit_label").each((function(){$(this).on("click",(function(t){if(debug[8]&&console.log("[label clicked] $ (event.target).html ():",$(t.target).html()),ignore_label_click_b)ignore_label_click_b=!1;else{var e,r=(e="div"==t.target.tagName.toLowerCase()?$(t.target):$(t.target).parents("div.rdgm_edit_label"))[0].id.match(/rdgm([^-]+)/)[1];$label_clicked[r]=e;var a=e.parents("td.rdgm_edit_labels");a.find(".rdgm_edit_highlight_label").removeClass("label_click_highlight"),a.find(".rdgm_edit_label_head").hide(),a.find(".rdgm_edit_label_head_label_clicked").show(),e.find(".rdgm_edit_highlight_label").addClass("label_click_highlight"),q.label_dragstart(e,!0)}}))})),t.find("div.rdgm_edit_canvas div.ui-resizable-handle").remove(),t.find("div.rdgm_edit_image div.rdgm_edit_target").css("border-width","2px"),t.find(".rdgm_edit_highlight_label").css("border","none"),t.find(".rdgm_edit_highlight_label *").css("word-wrap","normal"),t.find("div.rdgm_edit_image").each((function(){var t=$(this).width(),e=$(this).height();$(this).find("img").attr("width",t).attr("height",e).removeAttr("sizes").removeAttr("srcset")})),q.init_rdgm_edit2(t,e,r)},this.init_rdgm_edit2=function(t,e,r){rdgmdata[e].$rdgm_edit||(rdgmdata[e].$rdgm_edit={});var a="rdgm"+e+"-q"+r;rdgmdata[e].$rdgm_edit[a]=t.clone(!0)},this.process_rdgm_pair=function(t,e,r,a,d){q.rwizard_b=r,"undefined"!=typeof rwizard&&(qw=rwizard),a?(n_rdgmzes=1,set_rwizard_data_b=!0,q.no_intro_b=[],debug[0]&&console.log("[process_rdgm_pair] htm.substr (0, 2000):",t.substr(0,2e3))):set_rwizard_data_b=!1,rdgmdata[e]={},rdgmdata[e].questions=[],rdgmdata[e].answered_correctly=[],rdgmdata[e].n_correct=0,rdgmdata[e].n_incorrect=0,rdgmdata[e].i_question=-1,rdgmdata[e].i_user_question=-1,rdgmdata[e].ii_question=0,rdgmdata[e].user_question_number=0,rdgmdata[e].initial_width=500,rdgmdata[e].hangman={},rdgmdata[e].use_dataset="",rdgmdata[e].dataset_id={},rdgmdata[e].use_dataset_question_ids={},rdgmdata[e].bg_img={},rdgmdata[e].align="",rdgmdata[e].qrecord_id="",rdgmdata[e].qrecord_id_ok="check credit",rdgmdata[e].information_question_b={},rdgmdata[e].unit=[],rdgmdata[e].parts_htm={},rdgmdata[e].hotspot_user_interaction={},rdgmdata[e].hotspot_labels_stick={},rdgmdata[e].show_hotspots={},rdgmdata[e].find_the_dot={},rdgmdata[e].ctx={},rdgmdata[e].current_xy_hotspot_no={};var s=(z=t.match(/\[rdgm([^\]]*)\]/m))[0],o=z[1];s=qqc.replace_smart_quotes(s),o=qqc.replace_smart_quotes(o),debug[0]&&(console.log("[process_rdgm_pair] rdgm_tag: ",s),console.log("[process_rdgm_pair] attributes: ",o)),set_rwizard_data_b&&qw.set_rwizard_data("rdgm_deck_attributes",o);var i=!1;rdgmdata[e].icon_swhs=!0,rdgmdata[e].summary_b="false"!=get_attr(s,"summary");const _="true"==get_attr(s,"random");rdgmdata[e].random_b=_,q.rwizard_b&&(rdgmdata[e].attr_random_b=_);var n=get_attr(s,"use_dataset",!0);if(!n&&regular_page_f&&(n=get_attr(s,"dataset")),n){rdgmdata[e].use_dataset=n;var m=get_attr(s,"dataset_intro");m&&"true"!=m?"false"==m&&(m=!1):m=!0,rdgmdata[e].dataset_intro_f=m;var g="false"!=get_attr(s,"spaced_repetition");if(rdgmdata[e].dataset_questions_to_do=g?"spaced_repetition":"all",z=s.match(/\sstyle\s*=\s*"[^"]+"/gm))for(var c=z.length,l=0;l<c;l++){var u=encodeURIComponent(z[l]);s=s.replace(z[l],u)}var h=get_attr(s,"display_name");if(h){rdgmdata[e].use_dataset_options_display_name=decodeURIComponent(h);s=s.replace(/\sdisplay_name\s*=\s*"[^"]*?"/,"")}s=decodeURIComponent(s)}const p=parseInt(get_attr(s,"questions_to_show"));qqc.isInteger(p)&&p>0&&(rdgmdata[e].questions_to_show=p);var b=get_attr(o,"repeat_incorrect");rdgmdata[e].repeat_incorrect_b="false"!=b,debug[0]&&console.log("[create_rdgm_divs] repeat_incorrect_value:",b,", repeat_incorrect_b:",rdgmdata[e].repeat_incorrect_b);var f=get_attr(o,"align");"center"!=f&&"right"!=f&&"tiled"!=f||(rdgmdata[e].align=f,"tiled"==f&&(rdgmdata[e].spacing=20));var v=parseInt(get_attr(o,"spacing"));qqc.isInteger(v)&&(rdgmdata[e].spacing=v),rdgmdata[e].hide_forward_back_b="true"==get_attr(s,"hide_forward_back"),rdgmdata[e].hide_progress_b="true"==get_attr(s,"hide_progress"),rdgmdata[e].hide_r_diagrams_icon_b="true"==get_attr(s,"hide_r_diagrams_icon");var w=get_attr(s,"mobile_enabled");w||(w=document_rdgm_mobile_enabled),rdgmdata[e].mobile_enabled=w;var y=get_attr(o,"qrecord_id");if(y){rdgmdata[e].qrecord_id=y,rdgmdata[e].q_and_a_text={},rdgmdata[e].q_and_a_crc32={},q.qrecord_b||(q.qrecord_b=!0,"undefined"!=typeof document_rdgm_user_logged_in_b&&"not ready"!=document_rdgm_user_logged_in_b||qqc.check_session_id(e));var x=get_attr(o,"display_pay_screen");x&&"false"!=x?("true"==x||"login"==x?x="login":"register"==x&&(x="register"),rdgmdata[e].display_pay_screen=x):x=""}(q.rwizard_b||set_rwizard_data_b)&&get_attr(o,"dataset")&&(q.dataset_b=!0,set_rwizard_data_b&&(qw.questions_cards_dataset_b=!0));const k=get_attr(o,"question_time_limit");k?rdgmdata[e].question_time_limit=parseInt(k):rdgmdata[e].rdgm_timer="true"==get_attr(o,"quiz_timer");var A=get_attr(o,"unit");A?(rdgmdata[e].default_unit=A.replace(/\s/g,"_"),set_rwizard_data_b&&qw.set_rwizard_data("default_unit",A)):rdgmdata[e].default_unit="null";var z,C="",$=!1;if(z=t.match(/\[rdgm[^\]]*\]((<\/[^>]+>\s*)*)/m,"")){var I=z[1];debug[0]&&console.log("[process_rdgm_pair] initial_closing_tags: ",I)}t=(t=t.replace(/\[rdgm[^\]]*\]((<\/[^>]+>\s*)*)/m,"")).replace(/(<(p|h[1-6]|span)[^>]*>)*\[\/rdgm\]$/,"");var O=(z=(t=qqc.trim(t)).match(/\[(q|<code><\/code>q)([^\]]*)\]/gm))?z.length:0;if(n||q.rwizard_b||0!=O){var S=qqc.parse_html_block(t.substr(0,2e3),["^"],["[h]","[i]","[q]","[q "],"[<code></code>q","return whitespace");S&&(t=t.replace(S,"")),t=process_header(t,e,0,!0),set_rwizard_data_b&&"NA"!=header_html&&qw.set_rwizard_data("header_text",header_html);var j=qqc.parse_html_block(t.substr(0,5e3),["[i]"],["[q]","[q ","[<code></code>q",'<div class="rdgm_edit_question',"[x]"]);if("NA"==j)""==(j=qqc.parse_html_block(t.substr(0,5e3),["^"],["[q]","[q ","[<code></code>q",'<div class="rdgm_edit_question',"[x]"],!0))&&(n?j="<br /><br /><br />":$=!0);else{var E=t.substr(0,200);E=qqc.trim(E);var R=qqc.opening_tag_shortcode_pos("[i]",E);E=E.substr(R,5);var Y=j.replace(/<br[^>]*>/g,"");E!=(Y=qqc.trim(Y).substr(0,5))&&errmsgs.push(T("Text before intro")+" [i].  rdgm: "+(e+1)),j=j.replace("[i]",""),j=qqc.balance_closing_tag(j)}q.rwizard_b&&(j=qqc.shortcodes_to_video_elements(j)),(!$||q.rwizard_b||rdgmdata[e].question_time_limit)&&(debug[0]&&console.log("[process_rdgm_pair] intro_html:",j),C+='<div class="intro-rdgm'+e+' rdgm-intro rdgm_editable">'+qqc.decode_image_tags(j)+"</div>\n"),set_rwizard_data_b&&(intro_hmtl=qqc.remove_empty_opening_tags(j),qw.set_rwizard_data("intro_text",j));var B=qqc.parse_html_block(t,["[x]"],[]);if("NA"!=B)if(-1!=(B=B.replace(/\[x\]/,"")).search(/\[q[ \]]|<div class="rdgm_edit_question/))errmsgs.push("[x] "+T("(exit text) must be last")+".  rdgm: "+(e+1));else{var W=qqc.opening_tag_shortcode_pos("[x]",t);t=t.substr(0,W)}else B="";if(set_rwizard_data_b){var G=qqc.shortcodes_to_video_elements(B);G=qqc.remove_empty_opening_tags(G),qw.set_rwizard_data("exit_text",G)}if(n||-1!=t.search(/use_dataset_question\s*=\s*/)&&(i=!0,rdgmdata[e].use_dataset_questions_htm=t),n||i&&!d)d&&(rwizard.questions_cards_dataset_b=!1),C+='<div id="dataset_questions-rdgm'+e+'"></div>';else if(0==O)rdgmdata[e].n_questions=0,C+='<div id="rdgm'+e+'-q-1" class="rdgmq"></div>';else{rdgmdata[e].n_questions=O;const r=rdgmdata[e].questions_to_show;r&&r<O?(rdgmdata[e].n_questions_for_done=r,rdgmdata[e].random_b=!0):rdgmdata[e].n_questions_for_done=O,C=q.process_questions(t,C,e,void 0,void 0,d)}}else errmsgs.push(T('Did not find question tags ("[q]")')+".  rdgm: "+(e+1)),header_html="";return q.no_intro_b[e]=$&&!rdgmdata[e].question_time_limit,C=create_rdgm_divs(e,s,C,B),void 0!==q.rwizard_b&&"undefined"!=typeof rwizard&&(rwizard.errmsgs=errmsgs),C},this.process_questions=function(t,e,r,a,d,s){d&&(qw=rwizard,n_rdgmzes=1,set_rwizard_data_b=!0,q.rwizard_b=!0),number_first_question=void 0!==a?a:0,set_rwizard_data_b||-1!=t.indexOf("[!")&&(t=t.replace(/\[!+\][^]*?\[\/!+\]/gm,""));var o=t.match(/(\[q [^\]]*\]|<div class="rdgm_edit_question|\[q\])[^]*/m)[0],i=o.match(/\[(<code><\/code>)*q([^\]]*)\]/gm);(debug[4]||debug[11])&&console.log("[process_questions] question_shortcodes: ",i),n_questions=i.length,rdgmdata[r].question_topics=new Array(n_questions),q.rwizard_b&&(rdgmdata[r].rwizard_multiple_choice_b=[]),rdgmdata[r].units=[],rdgmdata[r].topics=[];for(var _=t.match(/(<[^\/][^>]*>\s*)*?(\[q[ \]]|\[<code><\/code>q)/gm),n=[],m=_.length,g=0;g<m;g++){var c=_[g];c=(c=c.replace(/\[q[ \]]|\[<code><\/code>q/gm,"")).replace(/[^]*<(img|input)[^>]+>/,""),n.push(c)}(debug[0]||debug[11])&&(console.log("[process_questions] q_opening_tags: ",n),console.log("[process_questions] question_html: ",o));var l="[q"!=o.substr(0,2);if(l)o=o.replace(/<div class="rdgm_edit_question[^>]*>/,"");else{var u=o.indexOf("]")+1;o=o.substr(u)}var h=o.split(/<div class="rdgm_edit_question[^_][^>]*>/);(debug[0]||debug[11])&&console.log("[process_questions] rdgm_edit_pieces.length:",h.length);var p=[];if(1==h.length){var b=o.split(/(?:<(?:p|h[1-6]|span)[^>]*>)*?(?:\[q [^\]]*\]|\[<code><\/code>q [^\]]*\]|\[q\]|\[<code><\/code>q\])/),f=0;l&&(p.push(b[0]+"[q]"+b[1]),f=2);for(var v=f;v<b.length;v++)p.push(b[v])}else if(h.length>1)if(l)for(var w=0;w<h.length;w++){b=h[w].split(/\[q [^\]]*\]|\[<code><\/code>q [^\]]*\]|\[q\]|\[<code><\/code>q\]/);p.push(b[0]+"[q]"+b[1]);for(v=2;v<b.length;v++)p.push(b[v])}else{for(b=h[0].split(/\[q [^\]]*\]|\[q\]/),v=0;v<b.length;v++)p.push(b[v]);for(w=1;w<h.length;w++){b=h[w].split(/\[q [^\]]*\]|\[<code><\/code>q [^\]]*\]|\[q\]|\[<code><\/code>q\]/);p.push(b[0]+"[q]"+b[1]);for(v=2;v<b.length;v++)p.push(b[v])}}if(set_rwizard_data_b&&void 0===a&&qw.set_rwizard_data("n_questions",n_questions),!q.rwizard_b){rdgmdata[r].n_questions=n_questions;const t=rdgmdata[r].questions_to_show;t&&t<n_questions?(rdgmdata[r].n_questions_for_done=t,rdgmdata[r].random_b=!0):rdgmdata[r].n_questions_for_done=n_questions}(debug[0]||debug[11])&&(console.log("[process_questions] n_questions:",n_questions),console.log("[process_questions] questions_html:",p.join("\n================================================\n")));for(var y,x=[],k=!1,A=0;A<n_questions;A++){var z,C=A+number_first_question;z=void 0!==a?i[0]:i[C],question_topic=process_question_attributes(r,C,z,a),question_topic&&(k=!0),rdgmdata[r].hotspot_b=!0,y=process_hotspot_diagram(r,C,p[A],n[A],s),x.push(y)}return e+=x.join("\n"),k&&debug[4]&&console.log("[process_questions] topics: "+rdgmdata[r].topics.join("; ")),set_rwizard_data_b&&(qw.unit_names=rdgmdata[r].units),rdgmdata[r].topics.length&&(check_questions_have_topics(r),set_rwizard_data_b&&(qw.topic_names=rdgmdata[r].topics)),(debug[3]||debug[11])&&console.log("[process_questions] new_htm: ",e),debug[12]&&console.log("[process_questions] errmsgs: ",errmsgs.join("\n")),e},this.rdgm_password_focus=function(t,e){t.rdgm_pw="",t.value="",$("#rdgm_login-rdgm"+e+" p.login_error").hide()},this.restart_quiz=function(t){var e=$("#summary-rdgm"+t);for(var r in e.hide(),e.find("button.summary_exit_mobile_rdgm").hide(),$("#rdgm"+t+" div.show_answer_got_it_or_not").hide(),1==rdgmdata[t].n_questions&&$("#rdgm"+t+" div.single-question_exit").hide(),rdgmdata[t].n_correct=0,rdgmdata[t].n_incorrect=0,rdgmdata[t].use_dataset&&(rdgmdata[t].information_question_b={},rdgmdata[t].hangman={},rdgmdata[t].textentry=""),q.display_progress(t),rdgmdata[t].$rdgm_edit)$("div#"+r).replaceWith(rdgmdata[t].$rdgm_edit[r]),rdgmdata[t].$rdgm_edit[r]=$("div#"+r).clone(!0);rdgmdata[t].rdgm_edit_b&&(rdgmdata[t].correct_on_try1=[]),$("#rdgm"+t).find("div.rdgmq").hide();for(var a=rdgmdata[t].n_questions,d=0;d<a;d++)rdgmdata[t].answered_correctly[d]=0,rdgmdata[t].questions[d]={};rdgmdata[t].hide_forward_back_b||($(".bbfe-rdgm"+t).css({visibility:"visible",opacity:.2}).removeClass("hover"),$("span.question-number-rdgm"+t).css({visibility:"visible"}).html(1)),rdgmdata[t].rdgm_timer&&rdgmdata[t].$rdgm_timer.html("0:00");for(var s=rdgmdata[t].topics.length,o=0;o<s;o++){var i=rdgmdata[t].topics[o];rdgmdata[t].topic_statistics[i].n_correct=0,rdgmdata[t].topic_statistics[i].n_incorrect=0}if(rdgmdata[t].i_question=-1,rdgmdata[t].i_user_question=-1,rdgmdata[t].ii_question=0,rdgmdata[t].user_question_number=0,rdgmdata[t].qrecord_id&&document_rdgm_user_logged_in_b){rdgmdata[t].record_start_b=!1;var _={qrecord_id_ok:rdgmdata[t].qrecord_id_ok,type:"start",confirm:"js"};qqc.jjax(qname,t,rdgmdata[t].qrecord_id,"record_response_v3",_)}q.init_question_order(t),q.next_question(t,!0)},this.record_quiz_time_callback=function(t){if(t.errmsg)alert(t.errmsg),rdgmdata[i_rdgm].when_done_unix=0;else{const e=t.i_rdgm;rdgmdata[e].quiz_elapsed_time_id=t.quiz_elapsed_time_id,rdgmdata[e].when_done_unix=t.when_done_unix}},this.redo_question=function(t){1==rdgmdata[t].n_questions&&$("#rdgm"+t+" div.single-question_exit").hide(),rdgmdata[t].i_question=rdgmdata[t].i_question-1,rdgmdata[t].answered_correctly[0]=0,rdgmdata[t].n_correct=0,q.next_question(t,!0)},this.next_question=function(t,e,r){if(debug[0]&&console.log("[next_question] rdgmdata[i_rdgm].i_question:",rdgmdata[t].i_question),rdgmdata[t].bck_f)return void q.fwd_question(t,!1);const a=$("div#overlay-times-up-rdgm"+t);a.is(":visible")&&a.hide();var d=rdgmdata[t].i_question;-1==d&&(rdgmdata[t].use_dataset&&rdgmdata[t].dataset_intro_f||$(".bbfe-rdgm"+t).css({visibility:"visible",opacity:.2}).removeClass("hover"));const s=rdgmdata[t].n_questions;debug[0]&&console.log("[next_question] i_question: ",d,", n_questions: ",s);var o="rdgm"+t,i=$("#"+o);document_rdgm_mobile?i.css("width",""):rdgmdata[t].width_reset&&($("#xrdgm"+t).length?i.css({width:rdgmdata[t].initial_width+"px","max-width":""}):i.css({width:"","max-width":""}),i.css({transform:""}),i[0].qscale_fac="",i[0].qstart_left="",i[0].qstart_top="",rdgmdata[t].width_reset=!1);var _=!1;if(r=!!r,-1!=d||r){var n=o+"-q"+d;if($("#"+n).hide(),document_rdgm_mobile&&$("#mobile_"+n).hide(),rdgmdata[t].pay_quiz_deck_id&&("preview_questions"==rdgmdata[t].pay_quiz_ok||"preview_period_expired"==rdgmdata[t].pay_quiz_ok||"no_free_trial"==rdgmdata[t].pay_quiz_ok)&&qqc.preview_limit("rdgm",rdgmdata,t))return}else if(rdgmdata[t].use_dataset||rdgmdata[t].use_dataset_questions_htm||s>1||q.rwizard_b){var m=-1;if(!q.no_intro_b[t]||rdgmdata[t].use_dataset_questions_htm){if(_=!0,!e&&!q.rwizard_b&&rdgmdata[t].qrecord_id){var g="undefined"!=typeof document_rdgm_user_logged_in_b&&document_rdgm_user_logged_in_b&&"undefined"!=typeof document_rdgm_username;if(!(g||"undefined"!=typeof document_rdgm_declined_login_b&&document_rdgm_declined_login_b))return q.display_login(t),!1;if(g){var c=!0;if(!$.cookie("rdgm_current_login_lt_nmin_ago")){c=!1;var l="";if(document_rdgm_team_b&&(l=" "+T("a team")+":"),confirm(T("You are logged in as")+l+" "+document_rdgm_username+".\n"+T('Do you want to continue?  (Click "Cancel" to sign out)'))){var u={path:"/",expires:qqc.get_rdgm_param("login_timeout_min",40)/1440};$.cookie("rdgm_current_login_lt_nmin_ago",1,u)}else qqc.sign_out(),document_rdgm_user_logged_in_b=!1}if(c&&document_rdgm_team_b&&!confirm(T("You are logged in as team")+": "+document_rdgm_username+".\n"+T("Do you want to continue as this team?"))){document_rdgm_session_id=document_rdgm_session_id.split(";")[0],document_rdgm_username=document_rdgm_username.split("; ")[0],document_rdgm_team_b=!1,qqc.set_user_menus_and_icons();var h=T("OK.  Only %s is logged in now");h=h.replace("%s",document_rdgm_username),alert(h)}if(rdgmdata[t].record_start_b=!1,document_rdgm_user_logged_in_b){var p={qrecord_id_ok:rdgmdata[t].qrecord_id_ok,type:"start",confirm:"js"};qqc.jjax(qname,t,rdgmdata[t].qrecord_id,"record_response_v3",p)}}}if(rdgmdata[t].use_dataset||rdgmdata[t].use_dataset_questions_htm){var b=rdgmdata[t].dataset_intro_f;b&&"topics_only"!=b?q.display_login(t,!1,"use_dataset_options"):($(".intro-rdgm"+t).hide(),qqc.get_dataset_questions(rdgmdata[t].use_dataset,qname,t,rdgmdata[t].qrecord_id,[],[],1e4,rdgmdata[t].dataset_questions_to_do,rdgmdata[t].random_b,rdgmdata[t].use_dataset_questions_htm),m=0)}}else q.no_intro_b[t]||rdgmdata[t].rdgm_timer&&start_rdgm_timer(t);q.next_question_from_intro(t,m)}else $("#mode-"+o).css("visibility","hidden");if(0!=s){if(next_button_active_b||($("#next_button-"+o).hide(),rdgmdata[t].next_button_show_b=!1),(-1!=d||r)&&rdgmdata[t].information_question_b[d]&&($("#next_button_text-rdgm"+t).html(T("Next question")),!q.rwizard_b&&(rdgmdata[t].answered_correctly[d]=1,rdgmdata[t].n_correct++,q.display_progress(t),1!=rdgmdata[t].user_question_number||!q.no_intro_b[t]&&1!=rdgmdata[t].n_questions||($("div#icon_rdgm"+t).hide(),alert_not_logged_in(t),rdgmdata[t].rdgm_timer&&start_rdgm_timer(t)),rdgmdata[t].qrecord_id&&document_rdgm_user_logged_in_b))){p={q_and_a_text:btoa(encodeURIComponent(rdgmdata[t].q_and_a_text[d])),q_and_a_crc32:rdgmdata[t].q_and_a_crc32[d],i_question:rdgmdata[t].dataset_id[d],unit:rdgmdata[t].unit[d],type:"information_only",response:"continue",correct_b:1,confirm:"js"};qqc.jjax(qname,t,rdgmdata[t].qrecord_id,"record_response_v3",p)}if(next_button_active_b&&rdgmdata[t].user_question_number==s)q.display_summary_and_exit(t);else if(!rdgmdata[t].use_dataset||-1!=d||r&&!q.rwizard_b){var f=rdgmdata[t].n_correct;rdgmdata[t].repeat_incorrect_b||(f+=rdgmdata[t].n_incorrect);var v=rdgmdata[t].n_questions_for_done;if(debug[0]&&console.log("[next_question] n_done:",f,", n_questions:",s,", n_questions_for_done:",v),f==v){m=rdgmdata[t].i_user_question;rdgmdata[t].questions[s]={i_user_prev_question:m,user_question_number:"--"},rdgmdata[t].questions[m].i_user_next_question=s,rdgmdata[t].i_user_question=s,rdgmdata[t].saved_i_question=s,$("span.question-number-rdgm"+t).html("--"),stop_rdgm_timer(t),q.display_summary_and_exit(t)}else{if(q.rwizard_b)rdgmdata[t].i_question++,d=rdgmdata[t].i_question;else for(var w;;){if((w=rdgmdata[t].ii_question)>=rdgmdata[t].n_questions_for_done&&(w=0,rdgmdata[t].ii_question=0),d=rdgmdata[t].question_order[w],rdgmdata[t].repeat_incorrect_b){if(1!=rdgmdata[t].answered_correctly[d]){rdgmdata[t].ii_question++;break}}else if(void 0===rdgmdata[t].answered_correctly[d]||0==rdgmdata[t].answered_correctly[d]){rdgmdata[t].ii_question++;break}rdgmdata[t].ii_question++}var y=rdgmdata[t].i_user_question;rdgmdata[t].i_question=d,void 0===rdgmdata[t].questions[d]&&(rdgmdata[t].questions[d]={});var x=rdgmdata[t].questions[d];if(y!=x.i_user_prev_question&&(x.i_user_prev_question=y),-1==y)rdgmdata[t].i_first_user_question=d,debug[0]&&console.log("[next_question] i_first_user_question:",d);else{var k=rdgmdata[t].questions[y];k?k.i_user_next_question=d:console.log("[next_question] prev_question for i_prev_question",y,"does not exist"),q.rwizard_b||$(".bck-question-rdgm"+t).css({opacity:.5}).addClass("hover")}rdgmdata[t].i_user_question=d,void 0===x.user_question_number&&(rdgmdata[t].user_question_number++,x.user_question_number=rdgmdata[t].user_question_number),q.rwizard_b||$("span.question-number-rdgm"+t).html(x.user_question_number),q.display_question(t,d,_),q.rwizard_b&&s&&(rwizard.set_rwizard_data("i_question",d),rwizard.go_to_question2(),"hotspot_diagram"!=qw.questions_cards[d].type&&q.display_progress(t))}}}else debug[0]&&console.log("[next_question] n_questions:",s)},this.next_question_from_intro=function(t,e){rdgmdata[t].n_questions&&($(".intro-rdgm"+t).hide(),q.no_intro_b[t]||($("#icon_rdgm"+t).hide(),rdgmdata[t].rdgm_timer&&start_rdgm_timer(t)),$(".bbfe-rdgm"+t).css({visibility:"visible",opacity:.2}).removeClass("hover"),$("span.question-number-rdgm"+t).html(1),$("#next_button-rdgm"+t).css("text-align","left"),rdgmdata[t].use_dataset||rdgmdata[t].use_dataset_questions_htm||q.display_progress(t,!0),$("#next_button_text-rdgm"+t).html(T("Next question")))},this.bck_question=function(t,e){if($(".bck-question-rdgm"+t).hasClass("hover")){rdgmdata[t].bck_f=!0;var r=rdgmdata[t].i_user_question,a=r;if(e){if(rdgmdata[t].use_dataset&&rdgmdata[t].dataset_intro_f)return rdgmdata[t].saved_i_question=rdgmdata[t].i_question,$(".bck-question-rdgm"+t).css({opacity:.2}).removeClass("hover"),$(".fwd-question-rdgm"+t).css({opacity:.5}).addClass("hover"),$("span.question-number-rdgm"+t).html("--"),hide_current_question(t,a),rdgmdata[t].i_question=-1,void q.display_login(t,!1,"use_dataset_options");r=rdgmdata[t].i_first_user_question}else if(-1==(r=rdgmdata[t].questions[r].i_user_prev_question))return;hide_current_question(t,a),$("div#summary-rdgm"+t).hide(),rdgmdata[t].i_user_question=r;var d=rdgmdata[t].questions[r];if(e||-1==d.i_user_prev_question){var s=$(".bck-question-rdgm"+t);rdgmdata[t].use_dataset&&rdgmdata[t].dataset_intro_f&&(s=s.last()),s.css({opacity:.2}).removeClass("hover")}var o=d.user_question_number;$("span.question-number-rdgm"+t).html(o),$(".fwd-question-rdgm"+t).css({opacity:.5}).addClass("hover"),rdgmq_id="rdgm"+t+"-q"+r,$("#"+rdgmq_id).show(),$("#next_button-rdgm"+t).hide(),document_rdgm_mobile&&$("#mobile_"+rdgmq_id).show()}},this.fwd_question=function(t,e){if($(".fwd-question-rdgm"+t).hasClass("hover")){if(-1==rdgmdata[t].i_question)$("#rdgm_login-rdgm"+t).hide();else{var r=rdgmdata[t].i_user_question,a="rdgm"+t+"-q"+r;$("#"+a).hide(),document_rdgm_mobile&&$("#mobile_"+a).hide()}e?(-1==rdgmdata[t].i_question&&(rdgmdata[t].i_question=rdgmdata[t].saved_i_question),r=rdgmdata[t].i_question):-1==rdgmdata[t].i_question?(r=rdgmdata[t].i_first_user_question,rdgmdata[t].i_question=rdgmdata[t].saved_i_question):r=rdgmdata[t].questions[r].i_user_next_question,rdgmdata[t].i_user_question=r;var d=rdgmdata[t].questions[r];r==rdgmdata[t].i_question&&(rdgmdata[t].bck_f=!1,$(".fwd-question-rdgm"+t).css({opacity:.2}).removeClass("hover"),rdgmdata[t].next_button_show_b&&$("#next_button-rdgm"+t).show());var s=d.user_question_number;$("span.question-number-rdgm"+t).html(s),r==rdgmdata[t].n_questions?$("div#summary-rdgm"+t).show():($("#"+(a="rdgm"+t+"-q"+r)).show(),document_rdgm_mobile&&$("#mobile_"+a).show(),rdgmdata[t].summary_b||s==rdgmdata[t].n_questions&&$("div#summary-rdgm"+t).show());var o=$(".bck-question-rdgm"+t);-1==d.i_user_prev_question&&(o=o.first()),o.css({opacity:.5}).addClass("hover")}},this.init_question_order=function(t){var e=rdgmdata[t].n_questions;rdgmdata[t].question_order=new Array(e);for(var r=0;r<e;r++)rdgmdata[t].question_order[r]=r;rdgmdata[t].random_b&&(rdgmdata[t].question_order=qqc.shuffle(rdgmdata[t].question_order),debug[0]&&console.log("[init_question_order] rdgmdata[i_rdgm].question_order:",rdgmdata[t].question_order))},this.display_question=function(t,e,r){var a="rdgm"+t+"-q"+e,d=$("div#"+a);debug[0]&&(console.log("[display_question] start_quiz_b:",r),console.log("[display_question] $rdgmq:",d)),d.find("[id^="+a+"-a]").hide(),(g=$("div#mobile_"+a)).find("[id^=mobile_"+a+"-a]").hide();var s=d.find('input[name="rdgm_img"]');s.length&&(s.changeElements("img"),g.find('input[name="rdgm_img"]').changeElements("img")),rdgmdata[t].question_time_limit&&start_rdgm_timer(t,rdgmdata[t].question_time_limit);var o=d.hasClass("rdgm_edit");if(o);else if(d.hasClass("hotspot_diagram")){const r=d.find("div.hotspot_image_stack");rdgmdata[t].$hotspot_image_stack[e]=r;const a=r.find("canvas.layer0_edited");if(q.rwizard_b)r.find("img.layer0_edited, img.rdgm_style_layer").addClass("rwizard_display_block_important"),r.find("div.rdgm_hotspot_label").removeClass("rwizard_display_none_important"),$("#icon_rdgm"+t).hide();else{rdgmdata[t].n_labels_correct=0,rdgmdata[t].n_label_attempts=0;const s=rdgmdata[t].show_hotspots[e],o=rdgmdata[t].find_the_dot[e];if(o){const a=create_find_the_dot_html(t,rdgmdata[t].find_the_dot[e]);r.before(a),r.find("img.rdgm_layer0, img.rdgm_style_layer").hide(),d.find("input.find_the_dot_dot_color").simpleColor({boxWidth:"25px",boxHeight:"17px",onSelect:find_the_dot_color_selected}),d.find("input.find_the_dot_background_color").simpleColor({boxWidth:"25px",boxHeight:"17px",onSelect:find_the_dot_color_selected}),q.update_find_the_dot(t,!1,!0),r.find("canvas.layer0_edited").css({outline:"1px dotted gray"}).show()}else{rdgmdata[t].spotmap_width[e]=a.data("rdgm_spotmap_width"),rdgmdata[t].spotmap_height[e]=a.data("rdgm_spotmap_height");const d=a.data("rdgm_sparsemap");rdgmdata[t].sparsemap[e]=d;const o=a.data("rdgm_spotmap");rdgmdata[t].spotmap[e]=d?JSON.parse(o.replace(/(\d+):/g,'"$1":')):new Uint8ClampedArray(base64js.toByteArray(o)),rdgmdata[t].hotspot_image_width[e]=a.attr("width"),rdgmdata[t].hotspot_image_height[e]=a.attr("height"),r.find("img.hotspot_only_image").hide(),s&&-1!=s.indexOf("always")&&r.find("img.rdgm_style_layer").show()}const g=rdgmdata[t].hotspot_user_interaction[e];var i;if(!g||"label_prompt"==g)if(-1==rdgmdata[t].answered_correctly[e]){var _=0;i=rdgmdata[t].n_hotspots[e];for(var n=0;n<i;n++){const r=rdgmdata[t].hotspot_nos[e][n]%1e3;rdgmdata[t].hotspot_nos[e][n]<0&&(rdgmdata[t].hotspot_nos[e][n]=-r,_++)}rdgmdata[t].n_hotspots_to_do[e]=_,debug[0]&&console.log("[display_question] n_hotspots_to_do:",_),rdgmdata[t].n_labels_correct=i-_,rdgmdata[t].n_label_attempts=0}const c=rdgmdata[t].hotspot_labels_stick[e];if(-1!=rdgmdata[t].answered_correctly[e]&&(rdgmdata[t].hotspot_nos[e]=[],rdgmdata[t].hotspot_labels[e]=[],rdgmdata[t].hotspot_ver2_f[e]=r.find(".rdgm_hotspot1").hasClass("rdgm_hotspot_ver2"),r.find("div.rdgm_hotspot_label").not(".rdgm_hotspot_deleted").each((function(){const r=$(this),a=r.attr("class").match(/ rdgm_hotspot(\d+)/)[1];rdgmdata[t].hotspot_nos[e].push(parseInt(a)),r.find("div.ui-resizable-handle").remove();var d=r.find("div.rdgm_hotspot_label_editable").text();d=qqc.remove_tags_eols(d),rdgmdata[t].hotspot_labels[e].push(d),!c||"keep"!=c&&"temporary"!=c||(r.off("mouseenter mouseleave"),r.on("mouseenter",(function(){r.css({opacity:.1})})).on("mouseleave",(function(){r.css({opacity:1})})))})),i=rdgmdata[t].hotspot_nos[e].length,rdgmdata[t].n_hotspots[e]=i,i||errmsgs.push(T("No hotspots set for hotspot_diagram"),NaN+(t+1)+", "+T("question")+" "+(e+1)),rdgmdata[t].n_hotspots_to_do[e]=i,debug[0]&&console.log("[display_question] n_hotspots:",i),s&&-1==s.indexOf("hide")&&!o&&init_hotspot_image_canvas(t,e,r)),rdgmdata[t].n_label_targets=i,rdgmdata[t].answered_correctly[e]=1,r.find("div.rdgm_hotspot_label").hide(),!g||"label_prompt"==g){d.find("div.hotspot_click_feedback").html("<b>Click on:</b>");const r=pick_random_hotspot(t,e);rdgmdata[t].current_query_hotspot_no[e]=r,set_hotspot_label_query(t,e,d)}r.off("click.hotspot_diagram_click"),g&&"info_only"==g?(rdgmdata[t].n_questions>1&&($("#next_button_text-rdgm"+t).html(T("Continue")),q.position_show_next_button(t),rdgmdata[t].next_button_show_b=!0,rdgmdata[t].answered_correctly[e]=1,rdgmdata[t].n_correct++),1==rdgmdata[t].user_question_number&&alert_not_logged_in(t)):r.on("click.hotspot_diagram_click",rdgm_.hotspot_diagram_click),(s&&-1!=s.indexOf("hover_show")||c&&-1!=c.indexOf("hover_show"))&&(r.off("mousemove click.mobile_hover_eq"),r.on("mousemove click.mobile_hover_eq",show_hotspot_on_hover),s&&-1==s.indexOf("keep")&&(r.off("mouseleave"),r.on("mouseleave",hide_hotspots)),rdgmdata[t].current_xy_hotspot_no=-1),rdgmdata[t].icon_swhs&&!rdgmdata[t].hide_r_diagrams_icon_b&&r.append(create_icon_rdgm_div(t));var m=S("Correctly clicked");g&&("find_hotspots"==g?m=S("Found"):"info_only"==g&&(m=S("Visited"))),q.display_diagram_progress(t,m)}}if(r&&qqc.is_mobile(rdgmdata[t].mobile_enabled))q.go_mobile(t);else if(document_rdgm_mobile){var g;(g=$("#mobile_rdgm"+t+"-q"+e)).length?g.show():d.show(),window.scrollTo(0,1)}else if(debug[0]&&console.log("[display_question] $rdgmq:",d),d.css("display","block"),q.rwizard_b){if(rdgmdata[t].use_dataset_question_ids[e]){var c=d.find(".rdgm_editable");c.length&&(c.removeClass("rdgm_editable"),!0)}else{var l=d.find("div.hangman_image").length;rwizard.init_tinymce("div#"+a+" .rdgm_editable",!1,l),!0}}var u="#rdgm"+t;q.preview&&(u+="-q"+e+".rdgmq_preview");var h=$(u);if(!document_rdgm_mobile&&!document_rdgm_force_mobile_f)if(o){var p=10+d.find("table.rdgm_edit_table").outerWidth();if(debug[0]&&console.log("[display_question] table_width:",p,", initial_width:",rdgmdata[t].initial_width),p>rdgmdata[t].initial_width&&(h.css({width:p+"px","max-width":"none"}),rdgmdata[t].width_reset=!0),q.rwizard_b)d.find(".rdgm_edit_highlight_label").addClass("no_move")}else{var b=d.find("img");if(b.length){var f=10+b.outerWidth();debug[0]&&console.log("[display_question] img_width:",f,", initial_width:",rdgmdata[t].initial_width),f>rdgmdata[t].initial_width&&(h.css({width:f+"px","max-width":"none"}),rdgmdata[t].width_reset=!0)}}if(h.length)if(h.is(":visible"))scale_quiz_to_container(h);else{new IntersectionObserver(scale_quiz_to_container_when_visible,{threshold:1}).observe(h[0])}},this.show_response_recorded=function(t){var e=rdgmdata[t].i_question,r=rdgmdata[t].questions[e],a=DateFormat.format.date((new Date).getTime(),"h:mm:ss");$("span.response_recorded_wrapper-rdgm"+t).css({display:"inline-block"});var d=$("span.response_recorded-rdgm"+t),s=$("span.response_recorded_shadow-rdgm"+t);d.addClass("response_recorded_jump").attr("title","Response to question "+r.user_question_number+" recorded "+a),s.css({display:"inline-block"});setTimeout((function(){d.removeClass("response_recorded_jump"),s.hide()}),500)},this.pay_lock_settings=function(t,e,r,a){qqc.pay_lock_settings(qname,rdgmdata,n_rdgmzes,e,r,a,t)},this.go_mobile=function(t){non_mobile_scrollLeft=window.scrollX,non_mobile_scrollTop=window.scrollY;var e=$("#rdgm"+t);if(rdgmdata[t].rdgm_style=e.attr("style"),e.removeAttr("style").removeClass("rdgm").addClass("rdgm-mobile rwizard_rdgm_deck_div"),e.after('<div id="rdgm_div_placeholder"></div>'),e.appendTo("body"),window.scrollTo(0,0),$("body").css({overflow:"hidden"}),$("#icon_rdgm"+t).hide(),qqc.is_mobile(rdgmdata[t].mobile_enabled)||!document_rdgm_force_mobile_f){e.find(".rdgm_edit_label_head_standard").hide(),e.find(".rdgm_edit_label_head_mobile").show();var r=rdgmdata[t].i_question;if(r<rdgmdata[t].n_questions&&!rdgmdata[t].login_show_b){var a="rdgm"+t+"-q"+r,d=$("#"+a),s=$("#mobile_rdgm"+t+"-q"+r);s.length?(s.show(),d.hide()):d.show()}rdgmdata[t].$rdgm_edit&&rdgmdata[t].$rdgm_edit[a]&&(reset_label_positions(d),e.css("width","")),$(".go-mobile-rdgm"+t).hide(),document_rdgm_force_mobile_f||($(".exit-mobile-rdgm"+t).show(),$("#mode-rdgm"+t).hide(),$("#icon-exit-mobile-rdgm"+t).show(),$("#summary-rdgm"+t).find("button.summary_exit_mobile_rdgm").show()),document_rdgm_mobile="mobile_",scale_quiz_to_container(e)}},this.open_panel_exit_mobile=function(t){$("#overlay-exit-mobile-rdgm"+t).show().animate({top:"0px"},500),panel_exit_mobile_open_b=!0,$("#icon-exit-mobile-rdgm"+t).hide()},this.close_panel_exit_mobile=function(t){return $(t).animate({top:"-100px"},500,(function(){$(this).hide(),$("div.icon-exit-mobile-rdgm").show()})),window.scrollTo($(window).scrollLeft(),1),panel_exit_mobile_open_b=!1,panel_exit_mobile_just_closed_b=!0,!1},this.exit_mobile=function(t){var e=$("#rdgm"+t);e.attr("style",rdgmdata[t].rdgm_style).removeClass("rdgm-mobile rwizard_rdgm_deck_div").addClass("rdgm"),$("#xrdgm"+t).length&&$("#rdgm"+t).css("width",rdgmdata[t].initial_width+"px"),$("#rdgm_div_placeholder").replaceWith(e),$("body").css({overflow:""}),window.scrollTo(non_mobile_scrollLeft,non_mobile_scrollTop),$("#overlay-exit-mobile-rdgm"+t).css({top:"-100px",display:"none"}),$(window).off("scroll"),e.find(".rdgm_edit_label_head_standard").show(),e.find(".rdgm_edit_label_head_mobile").hide();var r,a=rdgmdata[t].i_question,d="rdgm"+t+"-q"+a,s=$("#"+d);a>=0&&a<rdgmdata[t].n_questions&&!rdgmdata[t].login_show_b&&($("#mobile_rdgm"+t+"-q"+a).hide(),s.show());if((r=rdgmdata[t].$rdgm_edit&&rdgmdata[t].$rdgm_edit[d]?s.find("table.rdgm_edit_table"):s.find("img")).length){var o=10+r.outerWidth();if(o>rdgmdata[t].initial_width){var i="#rdgm"+t;q.preview&&(i+="-q"+a+".rdgmq_preview"),$(i).css({width:o+"px","max-width":"none"}),rdgmdata[t].width_reset=!0}rdgmdata[t].$rdgm_edit&&rdgmdata[t].$rdgm_edit[d]&&reset_label_positions(s)}$("div.icon-exit-mobile-rdgm, div.icon-panel-exit-mobile-rdgm").hide(),$(".exit-mobile-rdgm").hide(),$("button.summary_exit_mobile_rdgm").hide();const _=rdgmdata[t].mobile_enabled;("Always"==_||"Small screens only"==_&&qqc.is_mobile(_))&&$(".go-mobile-rdgm"+t).show(),document_rdgm_mobile="",panel_exit_mobile_just_closed_b=!1};var first_decode_err_f=!0,hotspot_long_hover_id,hotspot_label_hide_id;function cvt_feedback(t,e){var r,a;const d=void 0!==e;if(d)r=t.substr(0,e),a=t.substr(e);else{if(c_pos=t.indexOf("[c]"),-1==c_pos)return t;r=t.substr(0,c_pos),a=t.substr(c_pos+3)}var s,o;-1==(e=a.indexOf("[f]"))&&(e=a.indexOf("[fx]"));var i="";if(-1!=e)for(s=a.substr(e+3),a=a.substr(0,e);;){-1==(e=s.indexOf("[f]"))?o=s:(o=s.substr(0,e),s=s.substr(e+3));var _=(n=feedback_decode(o)).c;if(_&&(i+="[f]"+_),-1==e)break}var n=feedback_decode(a),m="",g="";if(!d)m="[c"+n.star+"]",g=n.c;return r+m+g+i}function feedback_decode(t){var e,r=t.indexOf("[Qq]"),a="";-1!=r?(e=t.substr(0,r),a=t.substr(r+4)):e=t,debug[2]&&console.log("[feedback_decode] s_to_decode:",e);var d="",s="",o=e.split(/<[^>]+>/);if(o.length>1){for(var i=e.match(/<[^>]+>/g),_=[],n=i.length,m=!0,g=0;g<n;g++){if(""!=(c=o[g])){m&&(m=!1,/ /.test(c)&&(d="*"));try{_.push(Base64.decode(c))}catch(t){}}-1!=i[g].indexOf("qcodeq")&&(reinit_highlighting_f=!0,i[g]=i[g].replace("qcodeq","code")),_.push(i[g])}try{var c=o[n];m&&/ /.test(c)&&(d="*"),_.push(Base64.decode(c))}catch(t){}s=_.join("")}else{/ /.test(e)&&(d="*");try{s=Base64.decode(e)}catch(t){}}return s+=a,debug[2]&&console.log("[feedback_decode] decoded_s:",s),{c:s,star:d}}function create_hangman_textentry_editable_divs(t,e,r,a,d,s,o){o=qqc.shortcodes_to_video_elements(o);var i=[],_=create_bg_img_style(t,e);i.push('<div id="rdgm'+t+"-q"+e+'" class="rdgmq rwizard_line_height"'+_+">\n"),void 0===rdgmdata[t].parts_htm[e]&&(rdgmdata[t].parts_htm[e]=[]);var n=0,m=1;for(o.length;;){var g=o.substr(n),c=g.search(s);if(-1==c)break;n+=c;var l=g.substr(0,c);1==m&&(l=r+l),-1==(l=qqc.remove_unmatched_tag(l,1==m)).search(/\S/)&&(l="&nbsp;"),rdgmdata[t].parts_htm[e][m]=l;var u=g.match(s);debug[9]&&console.log("[create_hangman_textentry_editable_divs] m[0]:",u[0]),n+=u[0].length,i.push('<div class="rdgm-question rdgm-question-'+d+" rdgm-parts rdgm-part"+m+' rdgm-inline rdgm_editable" data-i_part="'+m+'">\n'),i.push(l),i.push("</div>"),i.push(a[m-1]),m++}l=o.substr(n);return-1==(l=qqc.remove_unmatched_tag(l,!1,!0)).search(/\S/)&&(l="&nbsp;"),rdgmdata[t].parts_htm[e][m]=l,i.push('<div class="rdgm-question rdgm-question-'+d+" rdgm-parts rdgm-part"+m+' rdgm-inline rdgm_editable" data-i_part="'+m+'">\n'),i.push(l),i.push("</div>"),i.join("")}function update_hangman_input(t,e,r,a,d,s,o,i){for(var _=!1,n=!1,m=-1,g=new RegExp("u>"+t+"</u","i");;){var c=r.substr(m+1).match(g);if(!c)break;m+=c.index+2,e=qqc.setCharAt(e,m+1,c[0][2]),n=!0}debug[9]&&console.log("[update_hangman_input] keychar:",t,", good_char_b:",n);var l=rdgmdata[a].hangman[d],u=l.hangman_incorrect_chars[s],h=(_=!1,!1);if(n){l.hangman_current_entry[s]=e;var p=e.replace(/\t/g,"&ensp;");$(o).parents("span.rdgm_hangman.rdgm_hangman_c"+s).find("span.hangman_current_entry").html(p),(_=-1==e.indexOf("<u>\t</u>"))&&(l.n_hangman_done++,h=l.n_hangman_done==l.n_hangman)}else t=t.toLowerCase(),-1==u.indexOf(t)&&(u+=t).length>6&&(_=!0,l.n_hangman_done++,h=l.n_hangman_done==l.n_hangman),l.hangman_incorrect_chars[s]=u,debug[9]&&console.log("[hangman_keyup] hangman_incorrect_chars:",u);if(_){$(o).on("mousedown",(function(t){t.preventDefault()})),o.parentElement.done_f=!0;const t=l.hangman_n_hints[s];var b=u.length<=6&&0==t;if(b)l.n_hangman_correct++,l.n_hangman>1&&($("div#rdgm"+a+"-q"+d+" div.rdgm-feedback").hide(),$("div#rdgm"+a+"-q"+d+" div.rdgm_hangman_msg").hide()),$("#rdgm"+a+"-q"+d+"-a"+s).show(),h&&l.n_hangman_correct==l.n_hangman&&(q.rwizard_b||rdgmdata[a].n_correct++);else{l.n_hangman>1&&$("div#rdgm"+a+"-q"+d+" div.rdgm-feedback").hide();var f="<hr />";if(rdgmdata[a].repeat_incorrect_b){const r=e.match(/<u>[^\t]<\/u>/g);if(r){r.length;1==r.length?f+=T("You got one letter correct")+".&nbsp; ":f=(f+=T("You got %s letters correct")+".&nbsp; ").replace("%s",qqc.number_to_word(r.length)),1==t?f+=T("You used one hint")+".&nbsp; ":t>1&&(f+=T("You used %s hints")+".&nbsp; ",f=message.replace("%s",qqc.number_to_word(t))),u.length&&(f+=T("Incorrect letters")+": "+u+".&nbsp; "+T("Pick different letters when you see this word again."))}else f="<hr />"+T("Sorry, you entered more than six incorrect letters")+": "+u+".&nbsp; "+T("Choose different letters when you see this word again!")}else f="<hr />"+T("Sorry, you entered more than six incorrect letters.");$("div#rdgm"+a+"-q"+d+" div.rdgm_hangman_msg").html(f).show(),h&&l.n_hangman_correct!=l.n_hangman&&(q.rwizard_b||rdgmdata[a].n_incorrect++)}if(h){if(q.rwizard_b||(rdgmdata[a].answered_correctly[d]=l.n_hangman==l.n_hangman_correct?1:-1),o.blur(),rdgmdata[a].qrecord_id&&document_rdgm_user_logged_in_b){var v=l.hangman_answer[s],w={q_and_a_text:btoa(encodeURIComponent(rdgmdata[a].q_and_a_text[d])),q_and_a_crc32:rdgmdata[a].q_and_a_crc32[d],i_question:rdgmdata[a].dataset_id[d],unit:rdgmdata[a].unit[d],type:"hangman",response:v,correct_b:b?1:"",confirm:"js"};qqc.jjax(qname,a,rdgmdata[a].qrecord_id,"record_response_v3",w)}update_topic_statistics(a,d,b),update_progress_show_next(a)}else{var y=!0;for(s=0;s<l.n_hangman;s++)if(l.hangman_current_entry[s]!=l.hangman_final_entry[s]&&l.hangman_incorrect_chars[s].length<=6){var x=$("div#rdgm"+a+"-q"+d+" span.rdgm_hangman.rdgm_hangman_c"+s);y?(x.find("input").focus(),y=!1):x.find("span.hangman_type_letters").show()}}_=!0}return _}function single_char_textentry_keyup(t){var e=t.target;if(debug[6]&&console.log("[single_char_textentry_keyup] input_el:",e),-1==e.value.search(/[a-z0-9]/i))return e.value="",!1;var r=e.id.match(/rdgm([0-9]+)/)[1];debug[6]&&console.log("[single_char_textentry_keyup] i_rdgm:",r),1==rdgmdata[r].user_question_number&&($("div#icon_rdgm"+r).hide(),alert_not_logged_in(r),rdgmdata[r].rdgm_timer&&start_rdgm_timer(r)),q.textentry_check_answer(r,!0)}function process_feedback_item(t,e,r,a){debug[2]&&console.log("[process_feedback_item] choice_html: ",t);var d,s=qqc.parse_html_block(t,["[f]","[fx]"],["[f]","[fx]","[x]"]),o="";return"NA"!=s?(t=t.replace(s,""),debug[2]&&console.log("[process_feedback_item] feedback_item_html: ",s),d=-1!=s.indexOf("[fx]"),o=create_feedback_div_html(e,r,a,s=s.replace(/\[fx{0,1}\]/,""))):s="",debug[2]&&(console.log("[process_feedback_item] feedback_div:",o),console.log("[process_feedback_item] choice_html: ",t),console.log("[process_feedback_item] fx_b:        ",d)),{feedback_div:o,choice_html:t,feedback_item_html:s,fx_b:d}}function init_hotspot_image_canvas(t,e,r){const a=r.find("canvas.layer0_edited")[0],d=a.getContext("2d");rdgmdata[t].ctx[e]=d;const s=r.find("img.layer0_edited")[0];if(s.complete)d.drawImage(s,0,0,a.width,a.height);else{const t=new Image;t.src=s.src,t.onload=function(){d.drawImage(t,0,0,a.width,a.height)}}}function process_hotspot_diagram(t,e,r,a,d){debug[0]&&console.log("[process_hotspot_diagram] question_htm: ",r);var s=[];s.push('<div id="rdgm'+t+"-q"+e+'" class="rdgmq hotspot_diagram">');const o=r.indexOf('<div class="hotspot_image_stack"'),i=r.substr(0,o);if(q.rwizard_b){s.push('<div class="rdgm_editable rdgm-question">'),s.push(a+i),s.push("</div>");var _=r.substr(o),n="";if(c=_.match(/<img class="rdgm_layer0[^_][^>]*>/)){var m=c[0].match(/ src="([^"]*)"/);m&&(n=m[1])}s.push(_),s.push('<div style="clear: both;"></div>'),s.push('<div class="hotspot_click_feedback hotspot_click_feedback_correct   rdgm_editable"></div>'),s.push('<div class="hotspot_click_feedback hotspot_click_feedback_incorrect rdgm_editable"></div>')}else{s.push(a+r);const d=rdgmdata[t].hotspot_user_interaction[e];d&&"info_only"==d||(s.push('<div style="clear: both;"></div>'),s.push('<div class="hotspot_click_feedback"></div>'),s.push('<div class="hotspot_label_query"></div>'))}if(s.push("</div>"),set_rwizard_data_b&&(qw.questions_cards[e].type="hotspot_diagram",qw.questions_cards[e].question_text=i,qw.questions_cards[e].hotspot_image_src=n,qw.questions_cards[e].canvas_el=""),s=s.join("\n"),debug[0]&&console.log("[process_hotspot_diagram] htm:",s),rdgmdata[t].hotspot_nos||(rdgmdata[t].hotspot_nos={},rdgmdata[t].hotspot_labels={},rdgmdata[t].hotspot_highlighted_fs={},rdgmdata[t].hotspot_ver2_f={},rdgmdata[t].n_hotspots_to_do={},rdgmdata[t].$hotspot_image_stack={},rdgmdata[t].hotspot_image_width={},rdgmdata[t].hotspot_image_height={},rdgmdata[t].spotmap={},rdgmdata[t].spotmap_width={},rdgmdata[t].spotmap_height={},rdgmdata[t].sparsemap={},rdgmdata[t].n_hotspots={},rdgmdata[t].current_query_hotspot_no={}),rdgmdata[t].qrecord_id)if(qqc.isInteger(rdgmdata[t].dataset_id[e])){var g=qqc.remove_tags_eols(i);rdgmdata[t].q_and_a_text[e]=qqc.q_and_a_hash(g),rdgmdata[t].q_and_a_crc32[e]=rdgm_crc32(s),debug[0]&&(console.log("[process_hotspot_diagram] rdgmdata[i_rdgm].q_and_a_text[i_question]:",rdgmdata[t].q_and_a_text[e]),console.log("[process_hotspot_diagram] rdgmdata[i_rdgm].q_and_a_crc32[i_question]:",rdgmdata[t].q_and_a_crc32[e]))}else rdgmdata[t].q_and_a_text[e]=rdgmdata[t].dataset_id[e],rdgmdata[t].q_and_a_crc32[e]="dataset";if(d){var c;qw.questions_cards[e].question_html=i,(c=r.match(/rdgm_layer0[^"]+"\s+src="([^"]+)/))?qw.questions_cards[e].image_url=c[1]:(console.log("[process_hotspot_diagram] (did not find image) question_htm:",r),qw.questions_cards[e].image_url="NA");var l=[],u=[],h=[];const t=/<div\s*(id=""){0,1}\s*class="rdgm_hotspot_label /,a='<span class="hotspot_label_feedback_correct_content">',d='<span class="hotspot_label_feedback_incorrect_content">';for(var p=r;;){const e=p.search(t);if(-1==e)break;const r=qqc.find_matching_block(p.substr(e));var b,f,v;if(-1!=r.indexOf("rdgm_hotspot_deleted"))b="[deleted]",f="",v="";else{const t=r.search('<div class="hotspot_label_feedback');b=(b=(b=r.substr(0,t-6)).replace(/<div[^>]+>/,"")).replace(/<div[^>]+>/,"");const e=r.substr(t),s=e.search(a);f=(f=qqc.find_matching_block(e.substr(s)).substr(53)).replace(/<\/span>$/,"");const o=e.search(d);var w=e.substr(o);v=(v=(w=qqc.find_matching_block(w)).substr(55)).replace(/<\/span>$/,"")}l.push(b),u.push(f),h.push(v),p=p.substr(e+r.length)}if(qw.questions_cards[e].hotspot_labels=l,qw.questions_cards[e].feedback_corrects=u,qw.questions_cards[e].feedback_incorrects=h,(c=r.match(/<canvas.*?width="(\d+)/m))?qw.questions_cards[e].hotspot_image_width=c[1]:(console.log("[process_hotspot_diagram] (did not find canvas width) question_htm:",r),qw.questions_cards[e].hotspot_image_width=0),(c=r.match(/<canvas.*?height="(\d+)/m))?qw.questions_cards[e].hotspot_image_height=c[1]:(console.log("[process_hotspot_diagram] (did not find canvas height) question_htm:",r),qw.questions_cards[e].hotspot_image_height=0),(c=r.match(/rdgm_spotmap_width="(\d+)/m))?qw.questions_cards[e].spotmap_width=c[1]:(console.log("[process_hotspot_diagram] (did not find spotmap_width) question_htm:",r),qw.questions_cards[e].spotmap_width=0),(c=r.match(/rdgm_spotmap_height="(\d+)/m))?qw.questions_cards[e].spotmap_height=c[1]:(console.log("[process_hotspot_diagram] (did not find spotmap_height) question_htm:",r),qw.questions_cards[e].spotmap_height=0),c=r.match(/rdgm_sparsemap="(\d+)/m),qw.questions_cards[e].sparsemap=!!c&&"1"==c[1],(c=r.match(/rdgm_spotmap="([^"]+)/m))?qw.questions_cards[e].spotmap=c[1]:(console.log("[process_hotspot_diagram] (did not find spotmap) question_htm:",r),qw.questions_cards[e].spotmap=""),c=r.match(/img class="rdgm_style_layer[^"]+"\s+src="([^"]+)/)){var y=c[1];if("blob"==y.substr(0,4)){const t="wait"+(new Date).getTime();qqc.get_blob_as_data_url(t,y),y=t}qw.questions_cards[e].style_layer_src=y,debug[0]&&console.log("[process_hotspot_diagram] JSON.stringify (qw.questions_cards["+e+"]):",JSON.stringify(qw.questions_cards[e]))}}return s}function create_find_the_dot_html(t,e){const r=e.width,a=e.height,d=e.dot_color,s=e.background_color,o=e.controls;var i=[];const _=o?"block":"none";return i.push('<div class="find_the_dot_controls" style="display: '+_+'; margin-bottom: 2px;">'),i.push("Width"),i.push('<input class="find_the_dot_width"               type="text" onchange="'+qname+".update_find_the_dot ("+t+')" value="'+r+'" />'),i.push("Height"),i.push('<input class="find_the_dot_height"              type="text" onchange="'+qname+".update_find_the_dot ("+t+')" value="'+a+'"  />'),i.push('<button class="rdgm_button_small" style="background: gray;">'),i.push("Go"),i.push("   </button>"),i.push("&nbsp;"),i.push("Dot color"),i.push('<div class="rdgm_simplecolor_wrapper" style="z-index: 3;">'),i.push('<input class="find_the_dot_dot_color"        type="text" value="'+d+'" />'),i.push("</div>"),i.push("&nbsp;"),i.push("Background"),i.push('<div class="rdgm_simplecolor_wrapper" style="z-index: 2;">'),i.push('<input class="find_the_dot_background_color" type="text" value="'+s+'" />'),i.push("</div>"),i.push("</div>"),i.push('<button class="rdgm_button rdgm-smaller" style="float: right;" onclick="'+qname+".update_find_the_dot ("+t+', true)" title="Place dot at new random location">'),i.push("New dot"),i.push("</button>"),o&&i.push('One in <span class="find_the_dot_n_dots"></span>'),i.push("<br />"),i.join("\n")}function find_the_dot_color_selected(t,e){debug[0]&&console.log("[find_the_dot_color_selected] value:",t,", input_el:",e);const r=$(e).parents("div.rdgm")[0].id.substr(4),a=rdgmdata[r].i_question,d=($(e).hasClass("find_the_dot_dot_color")?"dot":"background")+"_color";rdgmdata[r].find_the_dot[a][d]="#"+t,q.update_find_the_dot(r)}this.hangman_show=function(t,e){if(suppress_hangman_hint_b)return suppress_hangman_hint_b=!1,!1;var r=$(t);if(r.find("span.hangman_type_letters").hide(),clearTimeout(t.i_hint_timeout),e){t.i_hint_timeout=setTimeout((function(){r.find("button.hangman_hint, span.hangman_status").fadeOut(1e3)}),750)}if(!t.done_f){r.find("button.hangman_hint").show();var a=r.find("span.hangman_status");a.html()&&a.show()}},this.hangman_hide=function(t){var e=$(t);t.i_hint_timeout=setTimeout((function(){e.find("button.hangman_hint, span.hangman_status").fadeOut(500)}),500)},this.hangman_keyup=function(t,e,r,a,d,s){1!=rdgmdata[a].user_question_number||!q.no_intro_b[a]&&1!=rdgmdata[a].n_questions||($("div#icon_rdgm"+a).hide(),alert_not_logged_in(a),rdgmdata[a].rdgm_timer&&start_rdgm_timer(a));var o=t.value;t.value=r,debug[9]&&console.log("[hangman_keyup] value.charCodeAt:",o.charCodeAt(0),o.charCodeAt(1),o.charCodeAt(2),o.charCodeAt(3));var i=o.replace(/[^a-z0-9]/gi,"");if(""==i)return!1;i=i.toLowerCase(),debug[9]&&console.log("[hangman_keyup] keychars:",i);for(var _=rdgmdata[a].hangman[d].hangman_current_entry[s],n=rdgmdata[a].hangman[d].hangman_final_entry[s],m=i.length,g=0;g<m;g++){var c;if(c=update_hangman_input(i[g],_,n,a,d,s,t))break}if(!c&&($("div#rdgm"+a+"-q"+d+" div.rdgm-feedback").hide(),$(t).parents("div.rdgmq").find("div.rdgm_hangman_msg").hide(),rdgmdata[a].hangman[d].hangman_incorrect_chars[s])){var l=rdgmdata[a].hangman[d].hangman_incorrect_chars_before_hint[s],u=qqc.create_hangman_incorrect_chars_display(rdgmdata[a].hangman[d].hangman_incorrect_chars[s],l,!0);$(t).parents("span.rdgm_hangman.rdgm_hangman_c"+s).find("span.hangman_status").html(u).show()}return!0},this.hangman_hint=function(t,e,r){if(rdgmdata[t].hangman[e].hangman_n_hints[r]++,rdgmdata[t].hangman[e].hangman_n_hints[r]>rdgmdata[t].hangman[e].hangman_max_hints)return!1;rdgmdata[t].hangman[e].hangman_n_hints[r]==rdgmdata[t].hangman[e].hangman_max_hints?$("#hangman_hint-rdgm"+t+"-q"+e+"-c"+r).attr("disabled",!0).addClass("rdgm_button_disabled"):rdgmdata[t].hangman[e].hangman_incorrect_chars_before_hint[r]=rdgmdata[t].hangman[e].hangman_incorrect_chars[r].length;rdgmdata[t].hangman[e].hangman_answer[r];var a=rdgmdata[t].hangman[e].hangman_current_entry[r],d=a.match(/<u>.<\/u>/g),s=d.indexOf("<u>\t</u>");if(debug[9]&&(console.log("[hangman_hint] matches:",d),console.log("[hangman_hint] i_pos:",s)),-1!=s){var o=rdgmdata[t].hangman[e].hangman_final_entry[r],i=(d=o.match(/<u>.<\/u>/g))[s][3],_=$("div#"+("rdgm"+t+"-q"+e)).find("span.rdgm_hangman.rdgm_hangman_c"+r+" input");update_hangman_input(i,a,o,t,e,r,_[0],!0),_.focus()}},this.create_hotspot_image=function(t,e,r,a,d){if(debug[0])var s=(new Date).getTime();const o=d.canvas.width,i=d.canvas.height,_=d.getImageData(0,0,o,i).data,n=(new Uint32Array(_.buffer),"rdgm_tmp_hotspot-only_canvas-rdgm"+t);var m=$("canvas."+n),g=!0;m.length||(g=!1,$("body").append('<canvas class="'+n+' rdgm_display_none" width="'+o+'" height="'+i+'"></canvas>'),m=$("canvas."+n));const c=m[0];var l=c.getContext("2d");const u=rdgmdata[t].find_the_dot[e];if(u){u.hotspot_only_new_f=!1,m.attr("width",o),m.attr("height",i),l.clearRect(0,0,o,i),l.beginPath();var[h,p,b]=qqc.hex_to_rgb(u.background_color.substr(1));h=255-h,p=255-p,b=255-b,l.strokeStyle="rgb("+h+", "+p+", "+b+")",l.lineWidth=2,l.arc(1+u.ix,1+u.iy,10,0,2*Math.PI),l.stroke();a.find("div.rdgm_hotspot_label.rdgm_hotspot"+r).css({left:8+u.ix,top:8+u.iy})}else{g&&(l.clearRect(0,0,o,i),l.beginPath());hotspot_indexof(rdgmdata[t].hotspot_nos[e],r);const a=rdgmdata[t].hotspot_ver2_f[e],[d,s,n]=q.hotspot_color_from_no(r,a);if(!a)if(11==r)var[f,v,w]=q.hotspot_color_from_no(1);else if(13==r)var[f,v,w]=q.hotspot_color_from_no(3);var y=!1;const m=$("div#rdgm"+t+"-q"+e),c=m.find("div.rdgm_hotspot_label.rdgm_hotspot1");var x,k=c.attr("data-border_all");k||(k=r);const u=(x=m.find("div.rdgm_hotspot_label.rdgm_hotspot"+k)).data("border_width");u&&"0"!=u&&(y=!0);var A=c.attr("data-highlight_all");if(A||(A=r),x=m.find("div.rdgm_hotspot_label.rdgm_hotspot"+A),!y){const t=x.data("highlight_brightness");t&&"0"!=t&&(y=!0)}if(!y){y=!!x.data("highlight_tint")}rdgmdata[t].hotspot_highlighted_fs[e]||(rdgmdata[t].hotspot_highlighted_fs[e]={}),rdgmdata[t].hotspot_highlighted_fs[e][r]=y;const h=o*i;if(y){const t=m.find("img.rdgm_style_layer")[0];if(t.complete)l.drawImage(t,0,0,o,i);else{const e=new Image;e.src=t.src,e.onload=function(){l.drawImage(e,0,0,o,i)}}var z=(I=l.getImageData(0,0,o,i)).data,C=new Uint32Array(z.buffer);for(let t=0;t<h;t++){let e=t<<2;if(_[e+3]==q.hotspot_alpha_value){const r=_[e],a=_[e+1],o=_[e+2];rgb_same(r,d)&&rgb_same(a,s)&&rgb_same(o,n)||(C[t]=0)}else C[t]=0}}else{var I;z=(I=l.getImageData(0,0,o,i)).data,C=new Uint32Array(z.buffer);const t=-1065320320;for(let e=0;e<h;e++){let o=e<<2;if(_[o+3]==q.hotspot_alpha_value){const i=_[o],m=_[o+1],g=_[o+2];rgb_same(i,d)&&rgb_same(m,s)&&rgb_same(g,n)?a||11!=r&&13!=r||rgb_same(i,f)&&rgb_same(m,v)&&rgb_same(g,w)&&(C[e]=t):C[e]=t}else C[e]=t}}l.putImageData(I,0,0)}const O=c.toDataURL();return debug[0]&&(console.log("[create_hotspot_image] dataURL:",O),console.log("[create_hotspot_image] msec:",(new Date).getTime()-s)),O},this.update_find_the_dot=function(t,e,r){const a=rdgmdata[t].i_question,d=$("div#rdgm"+t),s=$("div#rdgm"+t+"-q"+a),o=s.find("div.hotspot_image_stack"),i=o.find("canvas.layer0_edited"),_=i[0].getContext("2d");rdgmdata[t].ctx[a]=_;const n=parseInt(s.find("input.find_the_dot_width").val()),m=parseInt(s.find("input.find_the_dot_height").val());if(n<1||n>1e3||m<1||m>1e3)return void alert("Please enter a number between 1 and 1000");var g=rdgmdata[t].find_the_dot[a];if(g.hotspot_only_new_f=!0,!e){o.css({width:n,height:m}),i.attr("width",n),i.attr("height",m),rdgmdata[t].hotspot_image_width[a]=n,rdgmdata[t].hotspot_image_height[a]=m,s.find("span.find_the_dot_n_dots").html((n*m).toLocaleString());const e=10+parseInt(n);e>rdgmdata[t].initial_width&&(d.css({width:e+"px","max-width":"none"}),rdgmdata[t].width_reset=!0)}if(_.fillStyle=g.background_color,_.fillRect(0,0,n,m),(e||r)&&(g.ix=parseInt(Math.random()*n),g.iy=parseInt(Math.random()*m),e)){rdgmdata[t].n_labels_correct=0,rdgmdata[t].n_label_attempts=0,q.display_diagram_progress(t,S("Visited"));var c=rdgmdata[t].hotspot_nos[a];const e=c.length;for(let t=0;t<e;t++)c[t]=c[t]%1e3}const l=g.ix,u=g.iy;_.fillStyle=g.dot_color,_.fillRect(l,u,1,1),rdgmdata[t].sparsemap[a]=1;var h={};const p=Math.max(0,l-1),b=Math.min(n,l+2),f=Math.max(0,u-1),v=Math.min(m,u+2);for(var w=p;w<b;w++){h[w]={};for(var y=f;y<v;y++)h[w][y]=1}debug[0]&&console.log("[update_find_the_dot] spotmap:",h),rdgmdata[t].spotmap[a]=h,rdgmdata[t].spotmap_width[a]=n,rdgmdata[t].spotmap_height[a]=m},this.hotspot_diagram_click=function(t){debug[0]&&console.log("[hotspot_diagram_click] event:",event);const e=$(event.target).parents("div.rdgmq")[0].id.match(/rdgm(\d+)/)[1],r=rdgmdata[e].i_question;if(1==rdgmdata[e].user_question_number&&($("div#icon_rdgm"+e).hide(),alert_not_logged_in(e),rdgmdata[e].rdgm_timer&&start_rdgm_timer(e)),-1==rdgmdata[e].use_dataset.indexOf("secure_hotspot")){const t=is_xy_hotspot(e,r,event.offsetX,event.offsetY);q.hotspot_diagram_click2(e,r,t)}else{const t={use_dataset:rdgmdata[e].use_dataset,dataset_id:rdgmdata[e].dataset_id[r],i_question:r,ix:event.offsetX,iy:event.offsetY};qqc.qjax(qname,e,"","is_xy_hotspot",t)}},this.hotspot_diagram_click2=function(t,e,r){const a=rdgmdata[t].hotspot_nos[e],d=rdgmdata[t].current_query_hotspot_no[e],s=rdgmdata[t].$hotspot_image_stack[e];debug[0]&&console.log("[hotspot_diagram_click2] current_query_hotspot_no:",d),rdgmdata[t].n_label_attempts++;var o=rdgmdata[t].hotspot_user_interaction[e];o||(o="label_prompt");const i=rdgmdata[t].show_hotspots[e];var _=rdgmdata[t].hotspot_labels_stick[e];_||(_="hide");var n,m,g="",c=!1,l=!1,u=r>0;"label_prompt"==o?(m=d,u=r==d):m=r;const h=$("#rdgm"+t+"-q"+e);if(n=h.find("div.rdgm_hotspot_label.rdgm_hotspot"+m),m){var p=hotspot_indexof(a,m);-1==p&&(alert("Sorry, error"),p=0)}if("find_hotspots"==o&&(debug[0]&&console.log("[hotspot_diagram_click2] hotspot_nos:",a),Math.abs(a[p])>1e3&&(r=0,u=!1)),u){if(a[p]+=1e3*Math.sign(a[p]),i&&-1==i.indexOf("hide")){show_hotspot_on_hover();const a=s.find("img.rdgm_layer"+r),d=rdgmdata[t].hotspot_highlighted_fs[e][r]?"keep":"temporary";s.find("img.hotspot_only_image.hotspot_temporary").removeClass("hotspot_temporary").hide(),-1!=i.indexOf("temporary")?a.addClass("hotspot_temporary").show():-1!=i.indexOf("keep")&&a.addClass("hotspot_"+d).show()}if("temporary"==_&&s.find("div.rdgm_hotspot_label").hide(),"temporary"==_||"keep"==_){setTimeout((function(){n.css({display:"inline-block"})}),100),"keep"==_&&n.addClass("hotspot_clicked")}if(rdgmdata[t].n_labels_correct++,rdgmdata[t].n_hotspots_to_do[e]--,g="",(b=n.find("span.hotspot_label_feedback_correct_content")).length?(g=b.html(),g=qqc.is_only_tags_and_whitespace(g)?q.canned_feedback(!0):g.replace(/&nbsp;/g," ")):g=q.canned_feedback(!0),rdgmdata[t].n_hotspots_to_do[e]&&"label_prompt"==o){g+="<div><b>"+S("Now click on:")+"</b></div>";const r=pick_random_hotspot(t,e);0==r?rdgmdata[t].n_hotspots_to_do[e]=0:(rdgmdata[t].current_query_hotspot_no[e]=r,set_hotspot_label_query(t,e,h))}if(!rdgmdata[t].n_hotspots_to_do[e]){if(c=!0,set_hotspot_label_query(t,e,h,!0),s.off("mousemove click.hotspot_diagram_click click.mobile_hover_eq"),!q.rwizard_b&&!q.preview){if(l=1==rdgmdata[t].answered_correctly[e]){if(rdgmdata[t].n_correct++,"label_prompt"==o)g+="<div>"+S("You identified all of the items on the first try!")+"</div>";else if("find_hotspots"==o){const e=rdgmdata[t].n_label_attempts;e==a.length?g+="<div>"+S("You identified all of the items on the first try!")+"</div>":g=(g+="<div>"+plural(S("It took you one try"),S("It took you %s tries"),e)+" "+plural(S("to identify this item"),S("to identify these items"),rdgmdata[t].n_label_targets)+".</div>").replace("%s",qqc.number_to_word(e))}}else{const e=rdgmdata[t].n_label_attempts;g=(g+="<div>"+plural(S("It took you one try"),S("It took you %s tries"),e)+" "+plural(S("to identify this item"),S("to identify these items"),rdgmdata[t].n_label_targets)+".</div>").replace("%s",qqc.number_to_word(e)),rdgmdata[t].n_incorrect++}update_topic_statistics(t,e,l)}update_progress_show_next(t)}}else if(("label_prompt"==o||r>0)&&(a[p]=-d,rdgmdata[t].answered_correctly[e]=-1),i&&-1!=i.indexOf("keep")&&s.find("img.hotspot_only_image").removeClass("hotspot_clicked").hide(),"temporary"==_&&s.find("div.rdgm_hotspot_label").removeClass("hotspot_clicked").hide(),"label_prompt"==o){var b;if(g="",(b=n.find("span.hotspot_label_feedback_incorrect_content")).length?(g=b.html(),g=qqc.is_only_tags_and_whitespace(g)?q.canned_feedback(!1):g.replace(/&nbsp;/g," ")):g=q.canned_feedback(!1),rdgmdata[t].n_hotspots_to_do[e]>1)g+="<div><b>"+S("Now click on:")+"</b></div>";else{if(g+="<div>",0!=r){g+="You clicked on "+s.find("div.rdgm_hotspot_label.rdgm_hotspot"+r).html()}g+="&emsp;<b>"+S("Please try again")+":</b></div>"}const a=pick_random_hotspot(t,e);a&&(rdgmdata[t].current_query_hotspot_no[e]=a,set_hotspot_label_query(t,e,h))}h.find("div.hotspot_click_feedback").html(g);const f=S("label_prompt"==(!o||o)?"Correctly clicked":"Found");if(q.display_diagram_progress(t,f),rdgmdata[t].qrecord_id&&document_rdgm_user_logged_in_b){const d=rdgmdata[t].hotspot_labels[e],s=d[p];var v="";if(r!=m){const t=hotspot_indexof(a,r);-1!=t&&(v=d[t]),v+="\t"}var w={q_and_a_text:btoa(encodeURIComponent(rdgmdata[t].q_and_a_text[e])),q_and_a_crc32:rdgmdata[t].q_and_a_crc32[e],i_question:rdgmdata[t].dataset_id[e],unit:rdgmdata[t].unit[e],type:"hotspot_diagram",response:v+s,correct_b:"",confirm:"js"};if(qqc.jjax(qname,t,rdgmdata[t].qrecord_id,"record_response_v3",w),c){w={q_and_a_text:btoa(encodeURIComponent(rdgmdata[t].q_and_a_text[e])),q_and_a_crc32:rdgmdata[t].q_and_a_crc32[e],i_question:rdgmdata[t].dataset_id[e],unit:rdgmdata[t].unit[e],type:"hotspot_diagram",response:"done",correct_b:l?1:"",confirm:"js"};setTimeout((function(){qqc.jjax(qname,t,rdgmdata[t].qrecord_id,"record_response_v3",w)}),500)}}};var delay_hide_hotspot_no=-1;function show_hotspot_on_hover(){debug[0]&&console.log("[show_hotspot_on_hover] event:",event);const t=$(event.target).parents("div.rdgmq"),e=t[0].id.match(/rdgm(\d+)/)[1],r=rdgmdata[e].i_question,a=rdgmdata[e].current_xy_hotspot_no;var d=event.target.className;if(-1==d.indexOf("rdgm_hotspot_label")){const t=$(event.target).parents("div.rdgm_hotspot_label");d=t.length?t[0].className:""}if(d){const s=d.match(/rdgm_hotspot(\d+)/);if(s){const d=s[1];if(d==a||d==delay_hide_hotspot_no){clearTimeout(hotspot_label_hide_id),delay_hide_hotspot_no=-1,rdgmdata[e].on_hotspot_label=!0;const a=rdgmdata[e].hotspot_labels_stick[r];if(a&&-1==a.indexOf("keep")&&-1==a.indexOf("temporary")){const e=t.find("div.rdgm_hotspot_label.rdgm_hotspot"+d);e.off("mouseleave"),e.on("mouseleave",(function(){e.hide(),e.off("mouseleave")}))}}return}}rdgmdata[e].on_hotspot_label=!1;const s=is_xy_hotspot(e,r,event.offsetX,event.offsetY);if(s!=a){if(s){1==rdgmdata[e].user_question_number&&$("div#icon_rdgm"+e).hide();const t=rdgmdata[e].hotspot_user_interaction[r];if(t&&"find_hotspots"==t){const t=rdgmdata[e].hotspot_nos[r],a=hotspot_indexof(t,s);if(Math.abs(t[a])>1e3)return}}const d=rdgmdata[e].$hotspot_image_stack[r],i=rdgmdata[e].hotspot_user_interaction[r],_=function(){const a=rdgmdata[e].show_hotspots[r];if(a&&-1==a.indexOf("hide")){var o=rdgmdata[e].find_the_dot[r]?.hotspot_only_new_f;const t="rdgm_layer"+s;if(!o){var _=d.find("img."+t);o=0==_.length}if(o){const a=rdgmdata[e].ctx[r],o=q.create_hotspot_image(e,r,s,d,a);d.append('<img class="'+t+' hotspot_image_layer hotspot_only_image" />'),(_=d.find("img."+t))[0].src=o}_.show()}if(i&&"info_only"==i){const a=rdgmdata[e].hotspot_labels_stick[r];if(a&&-1!=a.indexOf("hover_show")){debug[0]&&console.log("[show_hotspot_on_hover2] (label) new_xy_hotspot_no:",s),-1!=a.indexOf("keep")&&t.find("div.rdgm_hotspot_label").css({opacity:.5});t.find("div.rdgm_hotspot_label.rdgm_hotspot"+s).css({display:"inline-block",opacity:1})}const d=rdgmdata[e].hotspot_nos[r],o=hotspot_indexof(d,s);d[o]<1e3&&(rdgmdata[e].n_labels_correct++,q.display_diagram_progress(e,S("Visited")),d[o]+=1e3)}};rdgmdata[e].current_xy_hotspot_no=s;var o="";if(a>0){debug[0]&&console.log("[show_hotspot_on_hover (hide previous)] prev_xy_hotspot_no:",a,", new_xy_hotspot_no:",s);const _=rdgmdata[e].hotspot_labels_stick[r],n=d.find("img.rdgm_layer"+a).not("img.hotspot_keep");if(o="hide",0==s){const t=rdgmdata[e].show_hotspots[r];i&&"info_only"==i&&t&&-1!=t.indexOf("keep")&&(o=""),o&&_&&-1!=_.indexOf("hover_show")&&i&&"info_only"==i&&(o="delay")}if(o&&(n.hide(),i&&"info_only"==i)){const d=rdgmdata[e].hotspot_labels_stick[r];if(d&&-1!=d.indexOf("hover_show")&&-1==d.indexOf("keep")&&-1==d.indexOf("temporary")){const e=t.find("div.rdgm_hotspot_label.rdgm_hotspot"+a);if("delay"==o){const t=function(){e.hide()};clearTimeout(hotspot_label_hide_id),hotspot_label_hide_id=setTimeout(t,700),delay_hide_hotspot_no=a}else e.hide()}else t.find("div.rdgm_hotspot_label").css({opacity:1})}}if(s){const t=rdgmdata[e].show_hotspots[r];t&&-1!=t.indexOf("long_hover_show")?(clearTimeout(hotspot_long_hover_id),hotspot_long_hover_id=setTimeout(_,700)):_()}}}function hide_hotspots(t){debug[0]&&console.log("[hide_hotspots] e:",t);const e=$(event.target).parents("div.rdgmq")[0].id.match(/rdgm(\d+)/)[1],r=rdgmdata[e].i_question;rdgmdata[e].current_xy_hotspot_no=-1,clearTimeout(hotspot_long_hover_id);const a=rdgmdata[e].show_hotspots[r],d=rdgmdata[e].hotspot_user_interaction[r];var s=!1;if(d&&"info_only"==d){const t=rdgmdata[e].hotspot_labels_stick[r];if((s=t&&-1!=t.indexOf("hover_show")&&-1==t.indexOf("keep"))&&rdgmdata[e].on_hotspot_label)return}a&&-1==a.indexOf("hide")&&(-1!=a.indexOf("temporary")||-1!=a.indexOf("keep")?($(t.currentTarget).find("img.hotspot_only_image").not("img.hotspot_keep").hide(),s&&$(t.currentTarget).find("div.rdgm_hotspot_label").not("div.hotspot_temporary").not("div.hotspot_keep").hide()):($(t.currentTarget).find("img.hotspot_only_image").hide(),s&&$(t.currentTarget).find("div.rdgm_hotspot_label").hide()))}function add_sub_color_variant(t,e,r,a=4){var d=t;const s=e*r*a;return t+s<=255?d+=s:d-=s,d}function rgb_same(t,e){return Math.abs(t-e)<=3}function hotspot_indexof(t,e){var r=-1;const a=t.length;for(var d=0;d<a;d++)if(Math.abs(t[d]%1e3)==e){r=d;break}return r}function is_xy_hotspot(t,e,r,a){const d=rdgmdata[t].hotspot_image_width[e],s=rdgmdata[t].hotspot_image_height[e],o=rdgmdata[t].spotmap[e],i=rdgmdata[t].spotmap_width[e],_=rdgmdata[t].spotmap_height[e],n=rdgmdata[t].sparsemap[e],m=Math.floor(r/d*i),g=Math.floor(a/s*_);var c;return n?(c=0,o[m]&&o[m][g]&&(c=o[m][g])):c=o[g*i+m],debug[0]&&console.log("[is_xy_hotspot] ix:",r,", iy:",a,", hotspot_no:",c),c}function pick_random_hotspot(t,e){const r=rdgmdata[t].hotspot_nos[e],a=rdgmdata[t].n_hotspots[e];var d=Math.floor(Math.random()*a),s=0;const o=Math.random()<.5?-1:1;for(var i=0;i<a;i+=o){const t=Math.abs(r[d]);if(t<1e3){s=t;break}(d+=o)>=a?d=0:d<0&&(d=a-1)}return 0==s&&alert("Sorry, error: no hotspot"),debug[0]&&(console.log("[pick_random_hotspot] hotspot_nos:",r),console.log("[pick_random_hotspot] hotspot_no:",s)),s}function set_hotspot_label_query(t,e,r,a){var d="";if(!a){const r=rdgmdata[t].current_query_hotspot_no[e];d=rdgmdata[t].$hotspot_image_stack[e].find("div.rdgm_hotspot_label.rdgm_hotspot"+r).html()}r.find("div.hotspot_label_query").html(d)}function process_header(t,e,r,a){var d=["[q]","[q ",'<div class="rdgm_edit_question'];if(null!=a&&d.push("[i]"),"NA"!=(header_html=qqc.parse_html_block(t.substr(0,1e3),["[h]"],d,!0))&&""!=header_html){var s=t.substr(0,200);s=qqc.trim(s);var o=qqc.opening_tag_shortcode_pos("[h]",s);s=s.substr(o,5);var i=header_html.replace(/<br[^>]*>/g,"");s!=(i=qqc.trim(i).substr(0,5))&&errmsgs.push(T("Text before header")+" [h].  rdgm: "+(e+1)),t=t.replace(header_html,""),header_html=header_html.replace(/\[h\]/gi,""),header_html=(header_html=qqc.balance_closing_tag(header_html)).replace(/<(p|h[1-6])[^>]*><\/(p|h[1-6])>/g,""),header_html=qqc.decode_image_tags(header_html)}return t}function shuffle(t){for(var e=t.length-1;e>0;){const r=Math.floor(Math.random()*(e+1)),a=t[e];t[e]=t[r],t[r]=a,e--}debug[0]&&console.log("[shuffle] a:",t)}function check_rdgm_tag_pairs(t){var e="",r=t.match(/\[rdgm|\[\/rdgm\]/gm);if(r){var a=r.length,d=!1;if(a%2!=0)d=!0;else for(var s=0;s<a;s++)if(s%2==0){if("[rdgm"!=r[s]){d=!0;break}}else if("[/rdgm]"!=r[s]){d=!0;break}if(d){debug[0]&&console.log("[check_rdgm_tag_pairs] (error_b) htm.substr (0, 1000):",t.substr(0,1e3));const r=t.search(/<[pa] class="more-link|<div class="(search|blog)-entry-readmore/);if(-1!=r){const a=t.indexOf("[rdgm");e=-1!=a?t.substring(0,a)+t.substr(r):t}else if(-1!=t.indexOf('class="entry-summary')){const r=t.indexOf("[rdgm"),a=t.search(/\s*\[\u2026\]/);e=-1!=r&&-1!=a?t.substring(0,r)+t.substr(a):t}else errmsgs.push(T("Unmatched [rdgm] - [/rdgm] pairs.")),e="NA";debug[0]&&console.log("[check_rdgm_tag_pairs] (error_b) new_htm:",e)}}return e}function update_topic_statistics(t,e,r){var a=rdgmdata[t].question_topics[e];if(a)for(var d=0;d<a.length;d++){var s=a[d];r?rdgmdata[t].topic_statistics[s].n_correct++:rdgmdata[t].topic_statistics[s].n_incorrect++}}function update_progress_show_next(t){if(rdgmdata[t].question_time_limit&&stop_rdgm_timer(t.true),rdgmdata[t].n_questions>1||rdgmdata[t].use_dataset){q.display_progress(t);var e=rdgmdata[t].n_correct;if(rdgmdata[t].repeat_incorrect_b||(e+=rdgmdata[t].n_incorrect),e==rdgmdata[t].n_questions_for_done&&(rdgmdata[t].summary_b?$("#next_button_text-rdgm"+t).html(T("View summary report")):$("#summary-rdgm"+t).show(),stop_rdgm_timer(t),rdgmdata[t].qrecord_id&&document_rdgm_user_logged_in_b&&(rdgmdata[t].use_dataset||rdgmdata[t].repeat_incorrect_b||0==rdgmdata[t].n_incorrect))){setTimeout((function(){qqc.jjax(qname,t,rdgmdata[t].qrecord_id,"record_response_v3",{type:"completed",confirm:"js"})}),2e3)}(e<rdgmdata[t].n_questions_for_done||rdgmdata[t].summary_b)&&q.position_show_next_button(t),rdgmdata[t].next_button_show_b=!0}1==rdgmdata[t].n_questions&&($("#rdgm"+t+" div.single-question_exit").show(),stop_rdgm_timer(t))}function create_feedback_div_html(t,e,r,a,d){var s="";null!=d&&(s=d);var o='<div id="rdgm'+t+"-q"+e+"-a"+r+s+'" class="rdgm-feedback">\n';s||(o+='<hr style="margin: 0px;" />\n');return s?o+='<div class="'+("c"==s?"rdgm_edit-correct_feedback":"rdgm_edit-incorrect_feedback")+' rdgm_editable" data-i_choice="'+r+'">'+a+"</div>":(q.rwizard_b&&(a=qqc.shortcodes_to_video_elements(a)),o+='<span class="rdgm-feedback-span rdgm_editable" data-i_choice="'+r+'">'+(a=create_restart_button(t,a,!0))+"</span>"),o+='<div style="clear: both;"></div>\n',o+="</div>\n",debug[2]&&console.log("[create_feedback_div_html] htm: ",o),o}function alert_not_logged_in(t){q.no_intro_b[t]&&rdgmdata[t].qrecord_id&&$.cookie("rdgm_user_login")&&("undefined"!=typeof document_rdgm_user_logged_in_b&&document_rdgm_user_logged_in_b&&"undefined"!=typeof document_rdgm_username||document_rdgm_declined_login_b||document_rdgm_not_logged_in_alerted||q.rwizard_b||-1==rdgmdata[t].qrecord_id.indexOf("finish_times_demo")&&(alert("Note: you are not logged in. You must be logged in to receive credit."),document_rdgm_not_logged_in_alerted=!0))}function redisplay_current_question(t,e){if(e<rdgmdata[t].n_questions)if(document_rdgm_mobile){var r=$("#mobile_rdgm"+t+"-q"+e);r.length?r.show():$("#rdgm"+t+"-q"+e).show()}else $("#rdgm"+t+"-q"+e).show();else $("#summary-rdgm"+t).show();$(".bbfe-rdgm"+t).css({visibility:"visible"}),$("span.question-number-rdgm"+t).css({visibility:"visible"})}function get_attr(t,e,r){var a=qqc.get_attr(t,e);return r&&!a&&(a=qqc.get_attr(t,e+"s")),a}function S(t){return qqc.T(t)}function T(t){return qqc.T(t)}function plural(t,e,r){return qqc.plural(t,e,r)}function inarray0(t,e){for(var r=t.length,a=0;a<r;a++)if(t[a][0]==e)return!0;return!1}this.hotspot_color_from_no=function(t,e=!1){var r;const a=t-1;if(r=[[202,198,191],[143,131,102],[239,210,130],[106,80,0],[251,209,30],[0,210,255],[0,123,201],[0,86,234],[123,132,147],[218,227,243]][a%10],a>9){const t=[[0,0,1],[0,1,0],[0,1,1],[1,0,0],[1,1,0],[1,1,1]][e?Math.floor(a/10)%5:a%5],d=Math.floor(a/60)+1,s=e?5:4;r[0]=add_sub_color_variant(r[0],t[0],d,s),r[1]=add_sub_color_variant(r[1],t[1],d,s),r[2]=add_sub_color_variant(r[2],t[2],d,s)}return r.push(q.hotspot_alpha_value),r},this.init_drag_and_drop=function(t){debug[0]&&console.log("[init_drag_and_drop] rdgmq_elm:",t);var e=$(t);e.removeAttr("onmouseover"),e.find("td.rdgm_edit_labels div.rdgm_edit_label").each((function(){(debug[0]||debug[8])&&(console.log("[init_drag_and_drop] $ (this):",$(this)),console.log("[init_drag_and_drop] 'td.rdgm_edit_labels div.rdgm_edit_label':",$(this)[0]));var t=$(this).offset();debug[8]&&console.log("[init_drag_and_drop] label_offset:",t),$(this).data("label_x",t.left).data("label_y",t.top),$(this).draggable({containment:$(this).parents("table.rdgm_edit_table"),start:function(t,e){var r=$(this).parents("div.rdgm");if(r.length){var a=r[0];a.qscale_fac&&(a.qstart_left=e.position.left,e.position.top?a.qstart_top=e.position.top:a.qstart_top=.1)}q.label_dragstart($(this))},drag:function(t,e){var r=$(this).parents("div.rdgm");if(r.length){var a=r[0];if(a.qscale_fac&&a.qstart_top){var d=a.qscale_fac;e.position.left=(e.position.left-a.qstart_left)/d+a.qstart_left,e.position.top=(e.position.top-a.qstart_top)/d+a.qstart_top}}}}).addClass("rdgm_edit_label_unplaced")})),e.find(".rdgm_edit_target").droppable({accept:".rdgm_edit_label",hoverClass:"rdgm_edit_target_hover",drop:function(t,e){q.label_dropped($(this),e.draggable)},tolerance:"pointer"})},this.display_summary_and_exit=function(t){if(q.rwizard_b||$(".bck-question-rdgm"+t).css({opacity:.5}).addClass("hover"),rdgmdata[t].summary_b){var e,r=[],a=rdgmdata[t].n_questions_for_done,d=rdgmdata[t].n_correct,s=rdgmdata[t].n_incorrect;if(rdgmdata[t].repeat_incorrect_b){var o=rdgmdata[t].use_dataset&&rdgmdata[t].dataset_intro_f?"set":"quiz";r.push("<p><b>"+T("Congratulations, you're done!")+"</b></p>"),e=(e=T(0==s?"quiz"==o?"In this %s-question quiz you answered every question correctly on the first try!":"In this %s-question set you answered every question correctly on the first try!":"quiz"==o?1==s?"In finishing this %s-question quiz you entered one incorrect answer":"In finishing this %s-question quiz you entered %s incorrect answers":1==s?"In finishing this %s-question set you entered one incorrect answer":"In finishing this %s-question set you entered %s incorrect answers")).replace("%s",qqc.number_to_word(a)),s>1&&(e=e.replace("%s",qqc.number_to_word(d)))}else e=0==s?T("Congratulations, you answered all questions correctly"):(e=(e=T("Your score is %s out of %s questions")).replace("%",qqc.number_to_word(d))).replace("%",qqc.number_to_word(a));r.push("<p>"+e+"</p>");var i,_=0;if(rdgmdata[t].topics&&(_=rdgmdata[t].topics.length),1==_){if("Other"!=(g=rdgmdata[t].topics[0]))1==a?r.push("<p>The question was about topic &ldquo;"+g+".&rdquo;</p>"):(i=2==a?T("Both"):T("All")+" "+qqc.number_to_word(a),r.push("<p>"+i+" "+plural(T("question"),T("questions"),a)+" were about topic &ldquo;"+g+".&rdquo;</p>"))}else if(_>1&&s>0){for(var n=[],m=0;m<_;m++){var g=rdgmdata[t].topics[m],c=(rdgmdata[t].topic_statistics[g].n_correct,rdgmdata[t].topic_statistics[g].n_incorrect);if(c>0){var l="<strong>"+(g=g.replace(/_/g," "))+"</strong>: "+qqc.number_to_word(c)+" "+T("incorrect");n.push(l)}}var u=n.length,h=[];if(u>1){h.push(T("These are the topics of questions that you answered incorrectly")),h.push("<ul>");for(var p=0;p<u;p++)h.push("<li>"),h.push(n[p]),h.push("</li>");h.push("</ul>")}else 1==s?h.push(T("The topic of the only question you answered incorrectly is")+"<br />"):h.push(T("The topic of the questions you answered incorrectly is")+"<br />"),h.push(n[0]);r.push(h.join("\n"))}if($("#summary_report-rdgm"+t).html(r.join("\n")),rdgmdata[t].rdgm_timer&&!q.rwizard_b&&!q.preview){var b={summary:1};const e=rdgmdata[t].qrecord_id;-1!=e.indexOf("finish_times_demo")&&(b.demo_taker_time=rdgmdata[t].elapsed_time),qqc.qjax(qname,t,e,"get_quiz_times",b)}}var f=$("#summary-rdgm"+t);q.rwizard_b&&0==f.find("div[contenteditable]").length&&rwizard.init_tinymce("div#rdgm_exit-rdgm"+t+".rdgm_editable");var v=f.find('input[name="rdgm_img"]');v.length&&v.changeElements("img"),rdgmdata[t].cv_index&&f.find("button.rdgm_restart").remove(),f.show(),rdgmdata[t].i_question=rdgmdata[t].n_questions},this.display_progress=function(t,e){if(debug[0]&&console.log("[display_progress] rdgmdata[i_rdgm].i_question:",rdgmdata[t].i_question,", came_from_start_b:",e),!rdgmdata[t].hide_progress_b){var r,a=rdgmdata[t].n_correct+rdgmdata[t].n_incorrect,d=rdgmdata[t].n_correct;if(rdgmdata[t].repeat_incorrect_b||(d+=rdgmdata[t].n_incorrect),q.rwizard_b)if(-1!=rdgmdata[t].i_question||e){var s=rdgmdata[t].i_question+1;e&&s++,r="Question "+s+" of "+rdgmdata[t].n_questions}else r=T("Questions in this quiz:")+" "+rdgmdata[t].n_questions;else{var o,i,_=rdgmdata[t].n_questions_for_done,n=_-d;if(0==a)r=T("Questions in this quiz:")+" "+n;else document_rdgm_mobile?(o=T("Qs"),i=T("not")):(o=T("questions"),i=T("incorrect")),r=_+" "+o+", "+a+" "+plural(T("response"),T("responses"),a)+", "+rdgmdata[t].n_correct+" "+T("correct")+", "+rdgmdata[t].n_incorrect+" "+i+", "+n+" "+T("to go")}$("#progress-rdgm"+t).html(r).show()}},this.display_diagram_progress=function(t,e="Correctly labeled",r=-1){if(!rdgmdata[t].hide_progress_b){var a,d,s=rdgmdata[t].i_question+1,o=rdgmdata[t].n_questions,i="";o>1&&!rdgmdata[t].random_b&&(i="Q #"+s+"/"+o+"; "),-1==r?(a=rdgmdata[t].n_labels_correct,d=rdgmdata[t].n_label_targets):(a=r,d=r),"Correctly labeled"==e&&(e=S("Correctly labeled")),i+=e+" "+a+" "+S("out of")+" "+d+" "+S("items"),$("#progress-rdgm"+t).html(i).show()}},this.canned_feedback=function(t){var e;if(t){var r=Math.floor(Math.random()*correct.length);e=correct[r]}else{r=Math.floor(Math.random()*incorrect.length);e=incorrect[r]}return e="<p><strong>"+e+"</strong></p>",debug[0]&&console.log("[canned_feedback] response:",e),e},this.keep_next_button_active=function(){next_button_active_b=!0,$(".next_button").show()},this.position_show_next_button=function(t){$("#next_button-rdgm"+t).show()},this.get_rdgmdata=function(t,e){return rdgmdata[t][e]},this.set_rdgmdata=function(i_rdgm,variable,value){if(-1==i_rdgm){var s=variable+" = "+value;eval(s)}else rdgmdata[i_rdgm][variable]=value}};rdgmf.call(rdgm_);
